{"ast":null,"code":"import _slicedToArray from \"/Users/mac/Desktop/projekte/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/mac/Desktop/projekte/esgrown/src/components/ind_dashboard_components/subscription-forms/rm-form.js\";\nimport React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\nimport axios from 'axios';\nexport default function Form(props) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        modalShow = _useState2[0],\n        setModalShow = _useState2[1];\n\n  const _useState3 = useState(\"\"),\n        _useState4 = _slicedToArray(_useState3, 2),\n        HLE = _useState4[0],\n        setHLE = _useState4[1];\n\n  const _useState5 = useState(\"\"),\n        _useState6 = _slicedToArray(_useState5, 2),\n        FT = _useState6[0],\n        setFT = _useState6[1];\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        spinner = _useState8[0],\n        setSpinner = _useState8[1];\n\n  const _useState9 = useState(\"\"),\n        _useState10 = _slicedToArray(_useState9, 2),\n        useremail = _useState10[0],\n        setUserEmail = _useState10[1];\n\n  const _useState11 = useState(\"\"),\n        _useState12 = _slicedToArray(_useState11, 2),\n        userId = _useState12[0],\n        setUserId = _useState12[1];\n\n  const _useState13 = useState(false),\n        _useState14 = _slicedToArray(_useState13, 2),\n        subStatus = _useState14[0],\n        setSubStatus = _useState14[1];\n\n  const _useState15 = useState(false),\n        _useState16 = _slicedToArray(_useState15, 2),\n        modalPayShow = _useState16[0],\n        setModalPayShow = _useState16[1];\n\n  const _useState17 = useState(\"\"),\n        _useState18 = _slicedToArray(_useState17, 2),\n        subPlan = _useState18[0],\n        setSubPlan = _useState18[1];\n\n  const _useState19 = useState(\"\"),\n        _useState20 = _slicedToArray(_useState19, 2),\n        amount = _useState20[0],\n        setAmount = _useState20[1];\n\n  const _useState21 = useState(0),\n        _useState22 = _slicedToArray(_useState21, 2),\n        button = _useState22[0],\n        setButton = _useState22[1];\n\n  const onChangePlan = e => {\n    const plan = e.target.value.split('/');\n    setSubPlan(plan[0]);\n    setAmount(plan[1]);\n    console.log(plan);\n  };\n\n  const onChangeHLE = e => {\n    setHLE(e.target.value);\n  };\n\n  const onChangeFT = e => {\n    setFT(e.target.value);\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n    const SubObject = {\n      user_id: props.user.id,\n      sub_status: false,\n      user_name: props.user.name,\n      user_email: props.user.email,\n      user_status: props.user.status,\n      highest_level_of_education: HLE,\n      field_of_training: FT\n    };\n\n    try {\n      setSpinner(true);\n      axios.post('http://localhost:5000/subscriptionrm/add', SubObject).then(res => {\n        console.log(res.data);\n        setSpinner(false);\n        setModalPayShow(true);\n        setModalShow(false);\n        setModalPayShow(true);\n      }).catch(err => {\n        console.log('Err: ' + err);\n        setSpinner(false);\n        setModalShow(false);\n      });\n    } catch (error) {\n      console.log(error);\n      setSpinner(false);\n      setModalShow(false);\n    }\n  }; //GET LOGGEDIN USER CREDENTIALS FOR PMT\n\n\n  useEffect(() => {\n    const userData = JSON.parse(sessionStorage.getItem('key'));\n    const userEmail = userData.email;\n    const userId = userData.id;\n    setUserEmail(userEmail);\n    setUserId(userId); //get sub status for user\n\n    axios.get(`http://localhost:5000/subscriptionrm/${userData.id}`).then(res => {\n      if (res.data[0].ref != null) {\n        // setSubStatus(res.data[0].sub_status);\n        setButton(1);\n      } else {\n        setButton(2);\n      }\n    }).catch(err => console.log(err));\n  }, []); //Paystack Functions\n\n  const onSuccess = res => {\n    console.log(res);\n    setModalPayShow(false);\n    const data = {\n      ref: res.reference,\n      sub_status: true,\n      plan_code: subPlan\n    };\n    console.log(data); //make axios call to update user reference\n\n    axios.post(`http://localhost:5000/subscriptionrm/update/rmref/${userId}`, data).then(res => console.log(res)).catch(err => console.log(err));\n  };\n\n  const close = () => {\n    console.log(\"Payment closed\");\n    setModalPayShow(false);\n  };\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ml-auto d-flex align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, button === 1 ? React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    disabled: true,\n    style: {\n      color: 'white',\n      background: '#97ba0d',\n      border: '#97ba0d'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Subscribed\") : button === 2 ? React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    onClick: () => setModalShow(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Subscribe\") : React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    onClick: () => setModalShow(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"Subscribe\"))), React.createElement(Modal, {\n    show: modalShow,\n    onHide: () => setModalShow(false),\n    \"aria-labelledby\": \"example-custom-modal-styling-title\",\n    centered: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(Modal.Body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    className: \"container py-4\",\n    onSubmit: onSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"h6\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Subscription Details\"))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"form-control\",\n    required: true,\n    onChange: onChangeHLE,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, \"Highest Level of Education\"), React.createElement(\"option\", {\n    value: \"degree\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, \"Degree\"), React.createElement(\"option\", {\n    value: \"masters\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, \"Masters\"), React.createElement(\"option\", {\n    value: \"phd\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, \"Ph.D\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"form-control\",\n    onChange: onChangeFT,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \" Select Field of Training\"), React.createElement(\"option\", {\n    value: \"VR\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Virtual Reality\"), React.createElement(\"option\", {\n    value: \"Data Science\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, \"Data Science\"), React.createElement(\"option\", {\n    value: \"Computer Science\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, \"Computer Science\"), React.createElement(\"option\", {\n    value: \"Medicine\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, \"Medicine\"), React.createElement(\"option\", {\n    value: \"AI\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  }, \"Artificial Intelligence\"), React.createElement(\"option\", {\n    value: \"Robotics\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, \"Robotics\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"form-control\",\n    required: true,\n    onChange: onChangePlan,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183\n    },\n    __self: this\n  }, \"Select Subscription Plan\"), React.createElement(\"option\", {\n    value: \"PLN_txgxcy2nqdqofkd/460000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, \"Biannual (six Months)\"), React.createElement(\"option\", {\n    value: \"PLN_d14bmlqitn9yce4/785000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185\n    },\n    __self: this\n  }, \"Annual (one Year)\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\",\n    disabled: spinner,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193\n    },\n    __self: this\n  }, \"Proceed \", spinner ? React.createElement(Spinner, {\n    as: \"span\",\n    animation: \"grow\",\n    size: \"sm\",\n    role: \"status\",\n    \"aria-hidden\": \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197\n    },\n    __self: this\n  }) : \"\", \" \")))))), React.createElement(PayStackButton, {\n    show: modalPayShow,\n    onHide: () => setModalPayShow(false),\n    close: close,\n    callback: onSuccess,\n    email: useremail,\n    amount: amount,\n    plan: subPlan,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }));\n}","map":{"version":3,"sources":["/Users/mac/Desktop/projekte/esgrown/src/components/ind_dashboard_components/subscription-forms/rm-form.js"],"names":["React","useState","useEffect","Fragment","Modal","Spinner","PayStackButton","axios","Form","props","modalShow","setModalShow","HLE","setHLE","FT","setFT","spinner","setSpinner","useremail","setUserEmail","userId","setUserId","subStatus","setSubStatus","modalPayShow","setModalPayShow","subPlan","setSubPlan","amount","setAmount","button","setButton","onChangePlan","e","plan","target","value","split","console","log","onChangeHLE","onChangeFT","onSubmit","preventDefault","SubObject","user_id","user","id","sub_status","user_name","name","user_email","email","user_status","status","highest_level_of_education","field_of_training","post","then","res","data","catch","err","error","userData","JSON","parse","sessionStorage","getItem","userEmail","get","ref","onSuccess","reference","plan_code","close","color","background","border"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\n\nimport axios from 'axios';\n\n\nexport default function Form(props) {\n    const [modalShow, setModalShow] = useState(false);\n    const [HLE, setHLE] = useState(\"\");\n    const [FT, setFT] = useState(\"\");\n    const [spinner, setSpinner] = useState(false);\n\n    const [useremail, setUserEmail] = useState(\"\");\n    const [userId, setUserId] = useState(\"\");\n    const [subStatus, setSubStatus] = useState(false);\n    const [modalPayShow, setModalPayShow] = useState(false);\n\n    const [subPlan, setSubPlan] = useState(\"\");\n    const [amount, setAmount] = useState(\"\");\n    const [button, setButton] = useState(0)\n\n\n\n    const onChangePlan = (e) => {\n        const plan = e.target.value.split('/');\n        setSubPlan(plan[0]);\n        setAmount(plan[1]);\n\n        console.log(plan)\n    }\n\n\n    const onChangeHLE = (e) => {\n        setHLE(e.target.value);\n    }\n\n    const onChangeFT = (e) => {\n        setFT(e.target.value);\n    }\n\n    const onSubmit = (e) => {\n        e.preventDefault();\n\n        const SubObject = {\n            user_id: props.user.id,\n            sub_status: false,\n            user_name: props.user.name,\n            user_email: props.user.email,\n            user_status: props.user.status,\n            highest_level_of_education: HLE,\n            field_of_training: FT\n        }\n\n\n        try {\n            setSpinner(true);\n            axios.post('http://localhost:5000/subscriptionrm/add', SubObject)\n                .then((res) => {\n                    console.log(res.data);\n                    setSpinner(false);\n                    setModalPayShow(true);\n                    setModalShow(false);\n                    setModalPayShow(true);\n\n                })\n                .catch(err => {\n                    console.log('Err: ' + err);\n                    setSpinner(false);\n                    setModalShow(false);\n                });\n\n        } catch (error) {\n            console.log(error);\n            setSpinner(false);\n            setModalShow(false);\n        }\n\n    }\n\n    //GET LOGGEDIN USER CREDENTIALS FOR PMT\n    useEffect(() => {\n        const userData = JSON.parse(sessionStorage.getItem('key'));\n        const userEmail = userData.email;\n        const userId = userData.id;\n        setUserEmail(userEmail);\n        setUserId(userId);\n\n        //get sub status for user\n        axios.get(`http://localhost:5000/subscriptionrm/${userData.id}`)\n            .then(res => {\n                if (res.data[0].ref != null) {\n                    // setSubStatus(res.data[0].sub_status);\n                    setButton(1);\n                } else {\n                    setButton(2);\n                }\n\n            })\n            .catch(err => console.log(err))\n\n    }, [])\n\n    //Paystack Functions\n    const onSuccess = (res) => {\n        console.log(res);\n        setModalPayShow(false);\n\n        const data = {\n            ref: res.reference,\n            sub_status: true,\n            plan_code: subPlan\n        }\n\n        console.log(data);\n        //make axios call to update user reference\n        axios.post(`http://localhost:5000/subscriptionrm/update/rmref/${userId}`, data)\n            .then(res => console.log(res))\n            .catch(err => console.log(err))\n\n    }\n\n    const close = () => {\n        console.log(\"Payment closed\");\n        setModalPayShow(false)\n    }\n\n\n    return (\n        <React.Fragment>\n            <div className=\"ml-auto d-flex align-items-center\">\n                <React.Fragment>\n                    {(button === 1) ? <button className=\"btn btn-info btn-sm\" disabled style={{ color: 'white', background: '#97ba0d', border: '#97ba0d' }}>Subscribed</button> : (button === 2) ? <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button> : <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button>}\n                </React.Fragment>\n\n            </div>\n            <Modal\n                show={modalShow}\n                onHide={() => setModalShow(false)}\n                aria-labelledby=\"example-custom-modal-styling-title\"\n                centered\n            >\n                <Modal.Body>\n                    <form className=\"container py-4\" onSubmit={onSubmit}>\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <h6>Subscription Details</h6>\n                            </div>\n                        </div>\n                        {/* Highest Level of Education */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangeHLE}>\n                                    <option>Highest Level of Education</option>\n                                    <option value=\"degree\">Degree</option>\n                                    <option value=\"masters\">Masters</option>\n                                    <option value=\"phd\">Ph.D</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Field of Training */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" onChange={onChangeFT}>\n                                    <option> Select Field of Training</option>\n                                    <option value=\"VR\">Virtual Reality</option>\n                                    <option value=\"Data Science\">Data Science</option>\n                                    <option value=\"Computer Science\">Computer Science</option>\n                                    <option value=\"Medicine\">Medicine</option>\n                                    <option value=\"AI\">Artificial Intelligence</option>\n                                    <option value=\"Robotics\">Robotics</option>\n                                </select>\n                            </div>\n                        </div>\n\n\n                        {/* Subscription Plan */}\n\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangePlan}>\n                                    <option>Select Subscription Plan</option>\n                                    <option value=\"PLN_txgxcy2nqdqofkd/460000\">Biannual (six Months)</option>\n                                    <option value=\"PLN_d14bmlqitn9yce4/785000\">Annual (one Year)</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* submit button */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    type=\"submit\"\n                                    className=\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\"\n                                    disabled={spinner}\n                                >Proceed {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : \"\"} </button>\n                            </div>\n                        </div>\n                    </form>\n                </Modal.Body>\n            </Modal>\n            <PayStackButton\n                show={modalPayShow}\n                onHide={() => setModalPayShow(false)}\n                close={close}\n                callback={onSuccess}\n                email={useremail}\n                amount={amount}\n                plan={subPlan}\n            />\n\n        </React.Fragment>\n    );\n}"]},"metadata":{},"sourceType":"module"}