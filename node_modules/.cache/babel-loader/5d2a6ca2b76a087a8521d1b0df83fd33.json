{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,Fragment}from'react';import{Modal,Spinner}from'react-bootstrap/';import PayStackButton from'../paystack/paystackpaymentbutton';import axios from'axios';export default function Form(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalShow=_useState2[0],setModalShow=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),HLE=_useState4[0],setHLE=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),FT=_useState6[0],setFT=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),spinner=_useState8[0],setSpinner=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),useremail=_useState10[0],setUserEmail=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),userId=_useState12[0],setUserId=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),subStatus=_useState14[0],setSubStatus=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),modalPayShow=_useState16[0],setModalPayShow=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),subPlan=_useState18[0],setSubPlan=_useState18[1];var _useState19=useState(\"\"),_useState20=_slicedToArray(_useState19,2),amount=_useState20[0],setAmount=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),button=_useState22[0],setButton=_useState22[1];var onChangePlan=function onChangePlan(e){var plan=e.target.value.split('/');setSubPlan(plan[0]);setAmount(plan[1]);console.log(plan);};var onChangeHLE=function onChangeHLE(e){setHLE(e.target.value);};var onChangeFT=function onChangeFT(e){setFT(e.target.value);};var onSubmit=function onSubmit(e){e.preventDefault();var SubObject={user_id:props.user.id,sub_status:false,user_name:props.user.name,user_email:props.user.email,user_status:props.user.status,highest_level_of_education:HLE,field_of_training:FT};try{setSpinner(true);axios.post('http://localhost:5000/subscriptionrm/add',SubObject).then(function(res){console.log(res.data);setSpinner(false);setModalPayShow(true);setModalShow(false);setModalPayShow(true);}).catch(function(err){console.log('Err: '+err);setSpinner(false);setModalShow(false);});}catch(error){console.log(error);setSpinner(false);setModalShow(false);}};//GET LOGGEDIN USER CREDENTIALS FOR PMT\nuseEffect(function(){var userData=JSON.parse(sessionStorage.getItem('key'));var userEmail=userData.email;var userId=userData.id;setUserEmail(userEmail);setUserId(userId);//get sub status for user\n// axios.get(`http://localhost:5000/subscriptionrm/${userData.id}`)\n//     .then(res => {\n//         if (res.data[0].ref != null) {\n//             // setSubStatus(res.data[0].sub_status);\n//             setButton(1);\n//         } else {\n//             setButton(2);\n//         }\n//     })\n//     .catch(err => console.log(err))\nif(userData.sub_status_rm==='active'){setSubStatus(userData.sub_status_rm);setButton(1);}else{setButton(2);}},[]);//Paystack Functions\nvar onSuccess=function onSuccess(res){console.log(res);setModalPayShow(false);//make a call to https://api.paystack.co/subscription and get all subscription \n//and filter for email of current subscription and extract subscription code.\n//update individual doc with the gotten data.\naxios.get(\"https://api.paystack.co/subscription\",{headers:{\"Authorization\":\"Bearer sk_test_19f4c12e4e018a9f742e1723d42c9c8e509800b4\"}}).then(function(res){var client=res.data.data.filter(function(st){return st.customer.email===useremail;});var data={ref:res.reference,sub_status:client[0].status,sub_code:client[0].subscription_code};//update eas substatus\naxios.post(\"http://localhost:5000/subscriptionrm/update/rmref/\".concat(userId),data).then(function(res){return console.log(res);}).catch(function(err){return console.log(err);});//update user details\naxios.post(\"http://localhost:5000/individuals/update/substatus/\".concat(userId),{sub_status_rm:client[0].status}).then(function(res){var globalUser=JSON.parse(sessionStorage.getItem('key'));globalUser.sub_status_rm=client[0].status;sessionStorage.setItem('key',JSON.stringify(globalUser));setButton(1);}).catch(function(err){return console.log(err);});}).catch(function(err){return console.log(err);});};var close=function close(){console.log(\"Payment closed\");setModalPayShow(false);};return React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"ml-auto d-flex align-items-center\"},React.createElement(React.Fragment,null,button===1?React.createElement(\"button\",{className:\"btn btn-info btn-sm\",disabled:true,style:{color:'white',background:'#97ba0d',border:'#97ba0d'}},\"Subscribed\"):button===2?React.createElement(\"button\",{className:\"btn btn-info btn-sm\",onClick:function onClick(){return setModalShow(true);}},\"Subscribe\"):React.createElement(\"button\",{className:\"btn btn-info btn-sm\",onClick:function onClick(){return setModalShow(true);}},\"Subscribe\"))),React.createElement(Modal,{show:modalShow,onHide:function onHide(){return setModalShow(false);},\"aria-labelledby\":\"example-custom-modal-styling-title\",centered:true},React.createElement(Modal.Body,null,React.createElement(\"form\",{className:\"container py-4\",onSubmit:onSubmit},React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"h6\",null,\"Subscription Details\"))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"select\",{className:\"form-control\",required:true,onChange:onChangeHLE},React.createElement(\"option\",null,\"Highest Level of Education\"),React.createElement(\"option\",{value:\"degree\"},\"Degree\"),React.createElement(\"option\",{value:\"masters\"},\"Masters\"),React.createElement(\"option\",{value:\"phd\"},\"Ph.D\")))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"input\",{label:\"\",type:\"text\",value:FT,onChange:onChangeFT,placeholder:\"Field of Training\",required:true,className:\"form-control\"}))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"select\",{className:\"form-control\",required:true,onChange:onChangePlan},React.createElement(\"option\",null,\"Select Subscription Plan\"),React.createElement(\"option\",{value:\"PLN_txgxcy2nqdqofkd/460000\"},\"Biannual (six Months) 4600\"),React.createElement(\"option\",{value:\"PLN_d14bmlqitn9yce4/785000\"},\"Annual (one Year) 7850\")))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"button\",{type:\"submit\",className:\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\",disabled:spinner},\"Proceed \",spinner?React.createElement(Spinner,{as:\"span\",animation:\"grow\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}):\"\",\" \")))))),React.createElement(PayStackButton,{show:modalPayShow,onHide:function onHide(){return setModalPayShow(false);},close:close,callback:onSuccess,email:useremail,amount:amount,plan:subPlan}));}","map":{"version":3,"sources":["/Users/mac/Desktop/esgrown/src/components/ind_dashboard_components/subscription-forms/rm-form.js"],"names":["React","useState","useEffect","Fragment","Modal","Spinner","PayStackButton","axios","Form","props","modalShow","setModalShow","HLE","setHLE","FT","setFT","spinner","setSpinner","useremail","setUserEmail","userId","setUserId","subStatus","setSubStatus","modalPayShow","setModalPayShow","subPlan","setSubPlan","amount","setAmount","button","setButton","onChangePlan","e","plan","target","value","split","console","log","onChangeHLE","onChangeFT","onSubmit","preventDefault","SubObject","user_id","user","id","sub_status","user_name","name","user_email","email","user_status","status","highest_level_of_education","field_of_training","post","then","res","data","catch","err","error","userData","JSON","parse","sessionStorage","getItem","userEmail","sub_status_rm","onSuccess","get","headers","client","filter","st","customer","ref","reference","sub_code","subscription_code","globalUser","setItem","stringify","close","color","background","border"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\n\nimport axios from 'axios';\n\n\nexport default function Form(props) {\n    const [modalShow, setModalShow] = useState(false);\n    const [HLE, setHLE] = useState(\"\");\n    const [FT, setFT] = useState(\"\");\n    const [spinner, setSpinner] = useState(false);\n\n    const [useremail, setUserEmail] = useState(\"\");\n    const [userId, setUserId] = useState(\"\");\n    const [subStatus, setSubStatus] = useState(false);\n    const [modalPayShow, setModalPayShow] = useState(false);\n\n    const [subPlan, setSubPlan] = useState(\"\");\n    const [amount, setAmount] = useState(\"\");\n    const [button, setButton] = useState(0)\n\n\n\n    const onChangePlan = (e) => {\n        const plan = e.target.value.split('/');\n        setSubPlan(plan[0]);\n        setAmount(plan[1]);\n\n        console.log(plan)\n    }\n\n\n    const onChangeHLE = (e) => {\n        setHLE(e.target.value);\n    }\n\n    const onChangeFT = (e) => {\n        setFT(e.target.value);\n    }\n\n    const onSubmit = (e) => {\n        e.preventDefault();\n\n        const SubObject = {\n            user_id: props.user.id,\n            sub_status: false,\n            user_name: props.user.name,\n            user_email: props.user.email,\n            user_status: props.user.status,\n            highest_level_of_education: HLE,\n            field_of_training: FT\n        }\n\n\n        try {\n            setSpinner(true);\n            axios.post('http://localhost:5000/subscriptionrm/add', SubObject)\n                .then((res) => {\n                    console.log(res.data);\n                    setSpinner(false);\n                    setModalPayShow(true);\n                    setModalShow(false);\n                    setModalPayShow(true);\n\n                })\n                .catch(err => {\n                    console.log('Err: ' + err);\n                    setSpinner(false);\n                    setModalShow(false);\n                });\n\n        } catch (error) {\n            console.log(error);\n            setSpinner(false);\n            setModalShow(false);\n        }\n\n    }\n\n    //GET LOGGEDIN USER CREDENTIALS FOR PMT\n    useEffect(() => {\n        const userData = JSON.parse(sessionStorage.getItem('key'));\n        const userEmail = userData.email;\n        const userId = userData.id;\n        setUserEmail(userEmail);\n        setUserId(userId);\n\n        //get sub status for user\n        // axios.get(`http://localhost:5000/subscriptionrm/${userData.id}`)\n        //     .then(res => {\n        //         if (res.data[0].ref != null) {\n        //             // setSubStatus(res.data[0].sub_status);\n        //             setButton(1);\n        //         } else {\n        //             setButton(2);\n        //         }\n\n        //     })\n        //     .catch(err => console.log(err))\n        if (userData.sub_status_rm === 'active') {\n\n            setSubStatus(userData.sub_status_rm);\n            setButton(1);\n\n        } else {\n            setButton(2);\n        }\n\n    }, [])\n\n    //Paystack Functions\n    const onSuccess = (res) => {\n        console.log(res);\n        setModalPayShow(false);\n\n        //make a call to https://api.paystack.co/subscription and get all subscription \n        //and filter for email of current subscription and extract subscription code.\n        //update individual doc with the gotten data.\n\n        axios.get(`https://api.paystack.co/subscription`, { headers: { \"Authorization\": \"Bearer sk_test_19f4c12e4e018a9f742e1723d42c9c8e509800b4\" } })\n            .then(res => {\n                const client = res.data.data.filter(st => {\n                    return st.customer.email === useremail\n                })\n\n                const data = {\n                    ref: res.reference,\n                    sub_status: client[0].status,\n                    sub_code: client[0].subscription_code\n                }\n\n                //update eas substatus\n                axios.post(`http://localhost:5000/subscriptionrm/update/rmref/${userId}`, data)\n                    .then(res => console.log(res))\n                    .catch(err => console.log(err))\n\n\n                //update user details\n                axios.post(`http://localhost:5000/individuals/update/substatus/${userId}`, { sub_status_rm: client[0].status, })\n                    .then(res => {\n                        const globalUser = JSON.parse(sessionStorage.getItem('key'));\n\n                        globalUser.sub_status_rm = client[0].status;\n\n                        sessionStorage.setItem('key', JSON.stringify(globalUser));\n                        setButton(1)\n\n                    }).catch(err => console.log(err))\n\n            }).catch(err => console.log(err));\n\n\n    }\n\n    const close = () => {\n        console.log(\"Payment closed\");\n        setModalPayShow(false)\n    }\n\n\n    return (\n        <React.Fragment>\n            <div className=\"ml-auto d-flex align-items-center\">\n                <React.Fragment>\n                    {(button === 1) ? <button className=\"btn btn-info btn-sm\" disabled style={{ color: 'white', background: '#97ba0d', border: '#97ba0d' }}>Subscribed</button> : (button === 2) ? <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button> : <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button>}\n                </React.Fragment>\n\n            </div>\n            <Modal\n                show={modalShow}\n                onHide={() => setModalShow(false)}\n                aria-labelledby=\"example-custom-modal-styling-title\"\n                centered\n            >\n                <Modal.Body>\n                    <form className=\"container py-4\" onSubmit={onSubmit}>\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <h6>Subscription Details</h6>\n                            </div>\n                        </div>\n                        {/* Highest Level of Education */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangeHLE}>\n                                    <option>Highest Level of Education</option>\n                                    <option value=\"degree\">Degree</option>\n                                    <option value=\"masters\">Masters</option>\n                                    <option value=\"phd\">Ph.D</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Field of Training */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <input\n                                    label=\"\"\n                                    type=\"text\"\n                                    value={FT}\n                                    onChange={onChangeFT}\n                                    placeholder=\"Field of Training\"\n                                    required\n                                    className=\"form-control\"\n                                />\n                                {/* <select className=\"form-control\" onChange={onChangeFT}>\n                                    <option> Select Field of Training</option>\n                                    <option value=\"VR\">Virtual Reality</option>\n                                    <option value=\"Data Science\">Data Science</option>\n                                    <option value=\"Computer Science\">Computer Science</option>\n                                    <option value=\"Medicine\">Medicine</option>\n                                    <option value=\"AI\">Artificial Intelligence</option>\n                                    <option value=\"Robotics\">Robotics</option>\n                                </select> */}\n                            </div>\n                        </div>\n\n\n                        {/* Subscription Plan */}\n\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangePlan}>\n                                    <option>Select Subscription Plan</option>\n                                    <option value=\"PLN_txgxcy2nqdqofkd/460000\">Biannual (six Months) 4600</option>\n                                    <option value=\"PLN_d14bmlqitn9yce4/785000\">Annual (one Year) 7850</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* submit button */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    type=\"submit\"\n                                    className=\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\"\n                                    disabled={spinner}\n                                >Proceed {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : \"\"} </button>\n                            </div>\n                        </div>\n                    </form>\n                </Modal.Body>\n            </Modal>\n            <PayStackButton\n                show={modalPayShow}\n                onHide={() => setModalPayShow(false)}\n                close={close}\n                callback={onSuccess}\n                email={useremail}\n                amount={amount}\n                plan={subPlan}\n            />\n\n        </React.Fragment>\n    );\n}"]},"metadata":{},"sourceType":"module"}