{"ast":null,"code":"import _slicedToArray from \"/Users/mac/Desktop/projekte/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/mac/Desktop/projekte/esgrown/src/components/ind_dashboard_components/subscription-forms/lm-form.js\";\nimport React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\nimport axios from 'axios';\nexport default function Form(props) {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        modalShow = _useState2[0],\n        setModalShow = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        spinner = _useState4[0],\n        setSpinner = _useState4[1];\n\n  const _useState5 = useState(\"\"),\n        _useState6 = _slicedToArray(_useState5, 2),\n        HLE = _useState6[0],\n        setHLE = _useState6[1];\n\n  const _useState7 = useState(\"\"),\n        _useState8 = _slicedToArray(_useState7, 2),\n        NOWP = _useState8[0],\n        setNOWP = _useState8[1];\n\n  const _useState9 = useState(\"\"),\n        _useState10 = _slicedToArray(_useState9, 2),\n        subPlan = _useState10[0],\n        setSubPlan = _useState10[1];\n\n  const _useState11 = useState(\"\"),\n        _useState12 = _slicedToArray(_useState11, 2),\n        amount = _useState12[0],\n        setAmount = _useState12[1];\n\n  const _useState13 = useState(false),\n        _useState14 = _slicedToArray(_useState13, 2),\n        modalPayShow = _useState14[0],\n        setModalPayShow = _useState14[1];\n\n  const _useState15 = useState(\"\"),\n        _useState16 = _slicedToArray(_useState15, 2),\n        useremail = _useState16[0],\n        setUserEmail = _useState16[1];\n\n  const _useState17 = useState(\"\"),\n        _useState18 = _slicedToArray(_useState17, 2),\n        userId = _useState18[0],\n        setUserId = _useState18[1];\n\n  const _useState19 = useState(false),\n        _useState20 = _slicedToArray(_useState19, 2),\n        subStatus = _useState20[0],\n        setSubStatus = _useState20[1];\n\n  const _useState21 = useState(0),\n        _useState22 = _slicedToArray(_useState21, 2),\n        button = _useState22[0],\n        setButton = _useState22[1];\n\n  const onChangeHLE = e => {\n    setHLE(e.target.value);\n  };\n\n  const onChangeNOWP = e => {\n    setNOWP(e.target.value);\n  };\n\n  const onChangePlan = e => {\n    const plan = e.target.value.split('/');\n    setSubPlan(plan[0]);\n    setAmount(plan[1]);\n    console.log(plan);\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n    const SubObject = {\n      user_id: props.user.id,\n      sub_status: false,\n      user_name: props.user.name,\n      user_email: props.user.email,\n      user_status: props.user.status,\n      highest_level_of_education: HLE,\n      nature_of_work_business: NOWP\n    };\n\n    try {\n      setSpinner(true);\n      axios.post('http://localhost:5000/subscriptionlm/add', SubObject).then(res => {\n        console.log(res.data);\n        setSpinner(false);\n        setModalShow(false);\n        setModalPayShow(true);\n      }).catch(err => {\n        console.log('Err: ' + err);\n        setSpinner(false);\n        setModalShow(false);\n      });\n    } catch (error) {\n      console.log(error);\n      setSpinner(false);\n      setModalShow(false);\n    }\n  }; //GET LOGGEDIN USER CREDENTIALS FOR PMT\n\n\n  useEffect(() => {\n    const userData = JSON.parse(sessionStorage.getItem('key'));\n    const userEmail = userData.email;\n    const userId = userData.id;\n    setUserEmail(userEmail);\n    setUserId(userId); //get sub status for user\n\n    axios.get(`http://localhost:5000/subscriptionlm/${userData.id}`).then(res => {\n      if (res.data[0].ref != null) {\n        // setSubStatus(res.data[0].sub_status);\n        setButton(1);\n      } else {\n        setButton(2);\n      }\n    }).catch(err => console.log(err));\n  }, []); //Paystack Functions\n\n  const onSuccess = res => {\n    console.log(res);\n    setModalPayShow(false);\n    const data = {\n      ref: res.reference,\n      sub_status: true,\n      plan_code: subPlan\n    }; //make axios call to update user reference\n\n    axios.post(`http://localhost:5000/subscriptionlm/update/lmref/${userId}`, data).then(res => console.log(res)).catch(err => console.log(err));\n  };\n\n  const close = () => {\n    console.log(\"Payment closed\");\n    setModalPayShow(false);\n  };\n\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"ml-auto d-flex align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, button === 1 ? React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    disabled: true,\n    style: {\n      color: 'white',\n      background: '#97ba0d',\n      border: '#97ba0d'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Subscribed\") : button === 2 ? React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    onClick: () => setModalShow(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Subscribe\") : React.createElement(\"button\", {\n    className: \"btn btn-info btn-sm\",\n    onClick: () => setModalShow(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Subscribe\"))), React.createElement(Modal, {\n    show: modalShow,\n    onHide: () => setModalShow(false),\n    \"aria-labelledby\": \"example-custom-modal-styling-title\",\n    centered: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(Modal.Body, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    className: \"container py-4\",\n    onSubmit: onSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"h6\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"Subscription Details\"))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"form-control\",\n    required: true,\n    onChange: onChangeHLE,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, \"Level of Education\"), React.createElement(\"option\", {\n    value: \"degree\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, \"Degree\"), React.createElement(\"option\", {\n    value: \"masters\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, \"Masters\"), React.createElement(\"option\", {\n    value: \"phd\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Ph.D\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(\"textarea\", {\n    value: NOWP,\n    onChange: onChangeNOWP,\n    rows: \"7\",\n    className: \"form-control\",\n    required: true,\n    placeholder: \"Nature of Work or Business\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"form-control\",\n    required: true,\n    onChange: onChangePlan,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, \"Select Subscription Plan\"), React.createElement(\"option\", {\n    value: \"PLN_hwug5s75tf2rcqu/289000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"Quarterly (three Months)\"), React.createElement(\"option\", {\n    value: \"PLN_072a7glz3tv6fzi/455000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Biannual (six Months)\"), React.createElement(\"option\", {\n    value: \"PLN_wma6tld3z1g2zef/797000\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, \"Annual (one Year)\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"submit\",\n    className: \"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\",\n    disabled: spinner,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176\n    },\n    __self: this\n  }, \"Proceed  \", spinner ? React.createElement(Spinner, {\n    as: \"span\",\n    animation: \"grow\",\n    size: \"sm\",\n    role: \"status\",\n    \"aria-hidden\": \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180\n    },\n    __self: this\n  }) : \"\")))))), React.createElement(PayStackButton, {\n    show: modalPayShow,\n    onHide: () => setModalPayShow(false),\n    close: close,\n    callback: onSuccess,\n    email: useremail,\n    amount: amount,\n    plan: subPlan,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }));\n}","map":{"version":3,"sources":["/Users/mac/Desktop/projekte/esgrown/src/components/ind_dashboard_components/subscription-forms/lm-form.js"],"names":["React","useState","useEffect","Fragment","Modal","Spinner","PayStackButton","axios","Form","props","modalShow","setModalShow","spinner","setSpinner","HLE","setHLE","NOWP","setNOWP","subPlan","setSubPlan","amount","setAmount","modalPayShow","setModalPayShow","useremail","setUserEmail","userId","setUserId","subStatus","setSubStatus","button","setButton","onChangeHLE","e","target","value","onChangeNOWP","onChangePlan","plan","split","console","log","onSubmit","preventDefault","SubObject","user_id","user","id","sub_status","user_name","name","user_email","email","user_status","status","highest_level_of_education","nature_of_work_business","post","then","res","data","catch","err","error","userData","JSON","parse","sessionStorage","getItem","userEmail","get","ref","onSuccess","reference","plan_code","close","color","background","border"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\nimport axios from 'axios';\n\n\nexport default function Form(props) {\n\n    const [modalShow, setModalShow] = useState(false);\n    const [spinner, setSpinner] = useState(false);\n    const [HLE, setHLE] = useState(\"\");\n    const [NOWP, setNOWP] = useState(\"\");\n\n    const [subPlan, setSubPlan] = useState(\"\");\n    const [amount, setAmount] = useState(\"\");\n    const [modalPayShow, setModalPayShow] = useState(false);\n    const [useremail, setUserEmail] = useState(\"\");\n    const [userId, setUserId] = useState(\"\");\n    const [subStatus, setSubStatus] = useState(false);\n    const [button, setButton] = useState(0)\n\n\n\n\n    const onChangeHLE = (e) => {\n        setHLE(e.target.value);\n    }\n\n    const onChangeNOWP = (e) => {\n        setNOWP(e.target.value);\n    }\n\n    const onChangePlan = (e) => {\n        const plan = e.target.value.split('/');\n        setSubPlan(plan[0]);\n        setAmount(plan[1]);\n        console.log(plan)\n    }\n\n    const onSubmit = (e) => {\n        e.preventDefault();\n\n        const SubObject = {\n            user_id: props.user.id,\n            sub_status: false,\n            user_name: props.user.name,\n            user_email: props.user.email,\n            user_status: props.user.status,\n            highest_level_of_education: HLE,\n            nature_of_work_business: NOWP\n        }\n\n        try {\n            setSpinner(true);\n            axios.post('http://localhost:5000/subscriptionlm/add', SubObject)\n                .then((res) => {\n                    console.log(res.data);\n                    setSpinner(false);\n                    setModalShow(false);\n                    setModalPayShow(true);\n\n                })\n                .catch(err => {\n                    console.log('Err: ' + err);\n                    setSpinner(false);\n                    setModalShow(false);\n                });\n        } catch (error) {\n            console.log(error);\n            setSpinner(false);\n            setModalShow(false);\n        }\n\n    }\n\n    //GET LOGGEDIN USER CREDENTIALS FOR PMT\n    useEffect(() => {\n        const userData = JSON.parse(sessionStorage.getItem('key'));\n        const userEmail = userData.email;\n        const userId = userData.id;\n        setUserEmail(userEmail);\n        setUserId(userId);\n\n        //get sub status for user\n        axios.get(`http://localhost:5000/subscriptionlm/${userData.id}`)\n            .then(res => {\n                if (res.data[0].ref != null) {\n                    // setSubStatus(res.data[0].sub_status);\n                    setButton(1);\n                } else {\n                    setButton(2);\n                }\n            })\n            .catch(err => console.log(err))\n\n    }, [])\n\n    //Paystack Functions\n    const onSuccess = (res) => {\n        console.log(res);\n        setModalPayShow(false);\n\n        const data = {\n            ref: res.reference,\n            sub_status: true,\n            plan_code: subPlan\n        }\n        //make axios call to update user reference\n        axios.post(`http://localhost:5000/subscriptionlm/update/lmref/${userId}`, data)\n            .then(res => console.log(res))\n            .catch(err => console.log(err))\n\n    }\n\n    const close = () => {\n        console.log(\"Payment closed\");\n        setModalPayShow(false)\n    }\n    return (\n        <React.Fragment>\n            <div className=\"ml-auto d-flex align-items-center\">\n                <React.Fragment>\n                    {(button === 1) ? <button className=\"btn btn-info btn-sm\" disabled style={{ color: 'white', background: '#97ba0d', border: '#97ba0d' }}>Subscribed</button> : (button === 2) ? <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button> : <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button>}\n                </React.Fragment>\n\n            </div>\n            <Modal\n                show={modalShow}\n                onHide={() => setModalShow(false)}\n                aria-labelledby=\"example-custom-modal-styling-title\"\n                centered\n            >\n                <Modal.Body>\n                    <form className=\"container py-4\" onSubmit={onSubmit} >\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <h6>Subscription Details</h6>\n                            </div>\n                        </div>\n                        {/* Level of Education */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangeHLE}>\n                                    <option>Level of Education</option>\n                                    <option value=\"degree\">Degree</option>\n                                    <option value=\"masters\">Masters</option>\n                                    <option value=\"phd\">Ph.D</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Intended Study field */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <textarea value={NOWP} onChange={onChangeNOWP} rows='7' className=\"form-control\" required placeholder=\"Nature of Work or Business\">\n\n                                </textarea>\n                            </div>\n                        </div>\n                        {/* Subscription Plan */}\n\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangePlan}>\n                                    <option>Select Subscription Plan</option>\n                                    <option value=\"PLN_hwug5s75tf2rcqu/289000\">Quarterly (three Months)</option>\n                                    <option value=\"PLN_072a7glz3tv6fzi/455000\">Biannual (six Months)</option>\n                                    <option value=\"PLN_wma6tld3z1g2zef/797000\">Annual (one Year)</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* submit button */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    type=\"submit\"\n                                    className=\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\"\n                                    disabled={spinner}\n                                >Proceed  {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : \"\"}\n                                </button>\n                            </div>\n                        </div>\n                    </form>\n                </Modal.Body>\n            </Modal>\n            <PayStackButton\n                show={modalPayShow}\n                onHide={() => setModalPayShow(false)}\n                close={close}\n                callback={onSuccess}\n                email={useremail}\n                amount={amount}\n                plan={subPlan}\n            />\n        </React.Fragment>\n    );\n}"]},"metadata":{},"sourceType":"module"}