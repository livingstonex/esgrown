{"ast":null,"code":"import _slicedToArray from \"/Users/mac/Desktop/projekte/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/mac/Desktop/projekte/esgrown/src/components/corp_dashboard_components/staff/staff.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Spinner, Dropdown, EditModal } from 'react-bootstrap';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport SearchBar from '../job/components/search';\nimport AddStaff from './components/add-staff';\nimport StaffDetails from './components/details';\nimport Rating from './components/rate';\nimport Edit from './components/edit';\nimport SchoolWeeks from './components/school-weeks';\nimport toast from '../../../util/toast';\nimport './styles.css';\n\nconst Staff = ({\n  ex_rankingpage\n}) => {\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        user = _useState2[0],\n        setUser = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        show = _useState4[0],\n        setShow = _useState4[1];\n\n  const _useState5 = useState([]),\n        _useState6 = _slicedToArray(_useState5, 2),\n        staff = _useState6[0],\n        setStaff = _useState6[1]; //modals\n\n\n  const _useState7 = useState(false),\n        _useState8 = _slicedToArray(_useState7, 2),\n        showDetails = _useState8[0],\n        setShowDetails = _useState8[1];\n\n  const _useState9 = useState(false),\n        _useState10 = _slicedToArray(_useState9, 2),\n        showrating = _useState10[0],\n        setShowRating = _useState10[1];\n\n  const _useState11 = useState(false),\n        _useState12 = _slicedToArray(_useState11, 2),\n        showEdit = _useState12[0],\n        setShowEdit = _useState12[1];\n\n  const _useState13 = useState(false),\n        _useState14 = _slicedToArray(_useState13, 2),\n        schoolWeeksmodal = _useState14[0],\n        setSchoolWeeksModal = _useState14[1];\n\n  const _useState15 = useState([]),\n        _useState16 = _slicedToArray(_useState15, 2),\n        details = _useState16[0],\n        setDetails = _useState16[1];\n\n  const _useState17 = useState(true),\n        _useState18 = _slicedToArray(_useState17, 2),\n        spinner = _useState18[0],\n        setSpinner = _useState18[1];\n\n  const _useState19 = useState(),\n        _useState20 = _slicedToArray(_useState19, 2),\n        weeks = _useState20[0],\n        setWeeks = _useState20[1];\n\n  const _useState21 = useState([]),\n        _useState22 = _slicedToArray(_useState21, 2),\n        lastDoc = _useState22[0],\n        setLastDoc = _useState22[1];\n\n  const _useState23 = useState(),\n        _useState24 = _slicedToArray(_useState23, 2),\n        target = _useState24[0],\n        setTarget = _useState24[1];\n\n  useEffect(() => {\n    const user = JSON.parse(sessionStorage.getItem('key'));\n    setUser(user);\n    axios.get(`http://localhost:5000/individuals/staff/${user.id}`).then(res => {\n      if (res.data.length > 0) {\n        setStaff(res.data);\n      }\n    }).catch(err => console.log(err)); //check if this is the beginning of the term and get the total weeks for the term\n\n    axios.get(`http://localhost:5000/rate/teacher/check/ftures`).then(res => {\n      setLastDoc(res.data.reverse()[0]);\n    }).catch(err => console.log(err));\n  }, []); //get the new school week and show rating modal\n\n  const getSchoolWeeks = w => {\n    setWeeks(w);\n    setSchoolWeeksModal(false);\n    displayDetails(target);\n  }; //close add modal and reload staff\n\n\n  const closeModal = () => {\n    setShow(false);\n    axios.get(`http://localhost:5000/individuals/staff/${user.id}`).then(res => {\n      if (res.data.length > 0) {\n        setStaff(res.data);\n      }\n    }).catch(err => console.log(err));\n  }; //get currently clicked staff\n\n\n  const getDetails = e => {\n    setTarget(e.currentTarget);\n    const current = e.target.getAttribute('data-current');\n\n    if (current === 'rate') {\n      if (lastDoc === undefined) {\n        setTarget(e.currentTarget);\n        setSchoolWeeksModal(true);\n        toast(\"Please tell us how many weeks are in your calendar this term\", \"info\");\n        return;\n      } else if (lastDoc.total_weeks === lastDoc.current_week) {\n        setTarget(e.currentTarget);\n        setSchoolWeeksModal(true);\n        toast(\"your Current Term has ended. Please start a new term\", \"info\");\n        return;\n      }\n    }\n\n    displayDetails(target, e);\n  }; //display modal based on selected action\n\n\n  const displayDetails = (target, e) => {\n    const id = e ? e.target.getAttribute('data-id') : target.getAttribute('data-id');\n    const current = e ? e.target.getAttribute('data-current') : target.getAttribute('data-current');\n\n    const loadModal = () => current === \"view\" ? setShowDetails(true) : current === \"rate\" ? setShowRating(true) : current === \"edit\" ? setShowEdit(true) : current === \"delete\" ? \"delete\" : \"\"; //get staff details from individuals\n\n\n    axios.get(`http://localhost:5000/individuals/details/${id}`).then(res => {\n      if (res.data) {\n        setSpinner(false);\n        setDetails(res.data);\n        loadModal();\n      }\n    }).catch(() => toast('An error occurred while trying to locate staff.Please try again', 'error'));\n  };\n\n  const closeRating = () => {\n    setShowRating(false);\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: \"container\",\n    style: {\n      marginTop: \"70px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row d-flex align-items-center justify-content-center\",\n    style: {\n      background: '#C4C4C4',\n      padding: '10px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-lg-8\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(SearchBar, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"col-lg-4\",\n    style: {\n      cursor: 'pointer'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"btn\",\n    style: {\n      background: '#53a6e7'\n    },\n    onClick: ex_rankingpage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, \"Excercise Ranking\"), React.createElement(\"div\", {\n    onClick: () => setShow(!show),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(AddCircleIcon, {\n    fontSize: \"large\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }), \" Add \", user && user.org_type === \"school\" ? \"teacher\" : \"staff\"))))), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col d-flex d-inline-flex\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \" pl-3 d-flex flex-fill align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"mb-0 text-color-2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, \"Name\")), React.createElement(\"div\", {\n    className: \"d-flex flex-fill align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"mb-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, \"Email\")), React.createElement(\"div\", {\n    className: \" d-flex flex-fill align-items-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    className: \"mb-0\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169\n    },\n    __self: this\n  }, \"Phone\")))), staff.map(st => {\n    return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      className: \"wrapper-list py-2 mt-2\",\n      style: {\n        backgroundColor: '#f5f5f5'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"container-fluid\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col d-flex justify-content-between\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"d-flex flex-fill align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 185\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"ml-2 mb-0 text-color-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 186\n      },\n      __self: this\n    }, st.fullname)), React.createElement(\"div\", {\n      className: \"d-flex flex-fill align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"ml-3 mb-0 \",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }, st.email)), React.createElement(\"div\", {\n      className: \"pr-2 d-flex flex-fill align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"ml-3 mb-0 text-color-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194\n      },\n      __self: this\n    }, st.phone)), React.createElement(\"div\", {\n      className: \"pr-2 d-flex flex-fill align-items-center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"ml-3 mb-0 text-color-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197\n      },\n      __self: this\n    }, st.tic)), React.createElement(\"div\", {\n      className: \"d-flex align-items-center ml-auto\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200\n      },\n      __self: this\n    }, React.createElement(Dropdown, {\n      alignRight: true,\n      color: 'red',\n      style: {\n        backgroundColor: '#f5f5f5'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201\n      },\n      __self: this\n    }, React.createElement(Dropdown.Toggle, {\n      id: \"dropdown-basic\",\n      style: {\n        color: 'black',\n        fontWeight: 'bolder'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }, \"....\"), React.createElement(Dropdown.Menu, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205\n      },\n      __self: this\n    }, React.createElement(Dropdown.Item, {\n      onClick: getDetails,\n      \"data-id\": st._id,\n      \"data-current\": \"view\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206\n      },\n      __self: this\n    }, \"View Details\"), React.createElement(Dropdown.Item, {\n      onClick: getDetails,\n      \"data-id\": st._id,\n      \"data-current\": \"edit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 207\n      },\n      __self: this\n    }, \"Edit \", user && user.org_type === \"school\" ? \"teacher\" : \"staff\"), React.createElement(Dropdown.Item, {\n      onClick: getDetails,\n      \"data-id\": st._id,\n      \"data-current\": \"rate\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208\n      },\n      __self: this\n    }, \"Rate \", user && user.org_type === \"school\" ? \"teacher\" : \"staff\"), React.createElement(Dropdown.Item, {\n      onClick: () => alert('Hello'),\n      \"data-current\": \"delete\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209\n      },\n      __self: this\n    }, \"Delete \", user && user.org_type === \"school\" ? \"teacher\" : \"staff\")))))))));\n  })), React.createElement(AddStaff, {\n    show: show,\n    onHide: () => setShow(!show),\n    closeModal: closeModal,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224\n    },\n    __self: this\n  }), React.createElement(StaffDetails, {\n    show: showDetails,\n    onHide: () => setShowDetails(!showDetails),\n    details: details,\n    spinner: spinner,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }), React.createElement(Rating, {\n    show: showrating,\n    onHide: () => setShowRating(!showrating),\n    details: details,\n    spinner: spinner,\n    closeModal: closeRating,\n    weeks: weeks,\n    lastDoc: lastDoc,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231\n    },\n    __self: this\n  }), React.createElement(Edit, {\n    show: showEdit,\n    onHide: () => setShowEdit(!showEdit),\n    details: details,\n    spinner: spinner,\n    user: user,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }), React.createElement(SchoolWeeks, {\n    show: schoolWeeksmodal,\n    onHide: () => setSchoolWeeksModal(!schoolWeeksmodal),\n    getSchoolWeeks: getSchoolWeeks,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248\n    },\n    __self: this\n  }));\n};\n\nexport default Staff;","map":{"version":3,"sources":["/Users/mac/Desktop/projekte/esgrown/src/components/corp_dashboard_components/staff/staff.js"],"names":["React","useState","useEffect","axios","Spinner","Dropdown","EditModal","AddCircleIcon","SearchBar","AddStaff","StaffDetails","Rating","Edit","SchoolWeeks","toast","Staff","ex_rankingpage","user","setUser","show","setShow","staff","setStaff","showDetails","setShowDetails","showrating","setShowRating","showEdit","setShowEdit","schoolWeeksmodal","setSchoolWeeksModal","details","setDetails","spinner","setSpinner","weeks","setWeeks","lastDoc","setLastDoc","target","setTarget","JSON","parse","sessionStorage","getItem","get","id","then","res","data","length","catch","err","console","log","reverse","getSchoolWeeks","w","displayDetails","closeModal","getDetails","e","currentTarget","current","getAttribute","undefined","total_weeks","current_week","loadModal","closeRating","marginTop","background","padding","cursor","org_type","map","st","backgroundColor","fullname","email","phone","tic","color","fontWeight","_id","alert"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Spinner, Dropdown, EditModal } from 'react-bootstrap';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport SearchBar from '../job/components/search';\nimport AddStaff from './components/add-staff';\nimport StaffDetails from './components/details';\nimport Rating from './components/rate';\nimport Edit from './components/edit';\nimport SchoolWeeks from './components/school-weeks';\nimport toast from '../../../util/toast';\nimport './styles.css';\n\n\n\nconst Staff = ({ex_rankingpage}) => {\n\n\n    const [user, setUser] = useState();\n    const [show, setShow] = useState(false);\n    const [staff, setStaff] = useState([]);\n\n    //modals\n    const [showDetails, setShowDetails] = useState(false);\n    const [showrating, setShowRating] = useState(false)\n    const [showEdit, setShowEdit] = useState(false);\n    const [schoolWeeksmodal, setSchoolWeeksModal] = useState(false);\n\n\n    const [details, setDetails] = useState([]);\n    const [spinner, setSpinner] = useState(true);\n    const [weeks, setWeeks] = useState();\n    const [lastDoc, setLastDoc] = useState([])\n    const [target, setTarget] = useState();\n\n    useEffect(() => {\n        const user = JSON.parse(sessionStorage.getItem('key'));\n        setUser(user);\n\n        axios.get(`http://localhost:5000/individuals/staff/${user.id}`)\n            .then(res => {\n                if (res.data.length > 0) {\n                    setStaff(res.data);\n                }\n            })\n            .catch(err => console.log(err));\n\n        //check if this is the beginning of the term and get the total weeks for the term\n\n        axios.get(`http://localhost:5000/rate/teacher/check/ftures`)\n            .then(res => {\n\n                setLastDoc(res.data.reverse()[0])\n            })\n            .catch(err => console.log(err));\n\n    }, [])\n\n    //get the new school week and show rating modal\n    const getSchoolWeeks = (w) => {\n        setWeeks(w);\n        setSchoolWeeksModal(false);\n        displayDetails(target)\n\n    }\n\n\n    //close add modal and reload staff\n    const closeModal = () => {\n        setShow(false);\n\n        axios.get(`http://localhost:5000/individuals/staff/${user.id}`)\n            .then(res => {\n                if (res.data.length > 0) {\n                    setStaff(res.data);\n                }\n            })\n            .catch(err => console.log(err));\n    };\n\n\n    //get currently clicked staff\n    const getDetails = (e) => {\n        setTarget(e.currentTarget)\n        const current = e.target.getAttribute('data-current');\n\n        if (current === 'rate') {\n            if (lastDoc === undefined) {\n                setTarget(e.currentTarget)\n                setSchoolWeeksModal(true)\n                toast(\"Please tell us how many weeks are in your calendar this term\", \"info\");\n                return;\n\n            } else if (lastDoc.total_weeks === lastDoc.current_week) {\n                setTarget(e.currentTarget)\n                setSchoolWeeksModal(true);\n                toast(\"your Current Term has ended. Please start a new term\", \"info\");\n                return;\n            }\n        }\n        \n        \n         displayDetails(target,e)\n\n    }\n    \n    //display modal based on selected action\n    const displayDetails = (target,e) => {\n\n        const id = e ? e.target.getAttribute('data-id') : target.getAttribute('data-id');\n        const current = e ? e.target.getAttribute('data-current') :target.getAttribute('data-current');\n\n        const loadModal = () => current === \"view\" ? setShowDetails(true) : current === \"rate\" ? setShowRating(true) : current === \"edit\" ? setShowEdit(true) : current === \"delete\" ? \"delete\" : \"\"\n\n        //get staff details from individuals\n        axios.get(`http://localhost:5000/individuals/details/${id}`)\n            .then(res => {\n                if (res.data) {\n                    setSpinner(false);\n                    setDetails(res.data);\n                    loadModal()\n                }\n            })\n            .catch(() => toast('An error occurred while trying to locate staff.Please try again', 'error'))\n    \n}\n\n\n    const closeRating = () => {\n        setShowRating(false)\n    }\n\n    return (\n        <>\n            <div className=\"container\" style={{marginTop:\"70px\"}}>\n\n                <div className=\"container\">\n                    <div className=\"row d-flex align-items-center justify-content-center\" style={{ background: '#C4C4C4', padding:'10px'}}>\n\n                        <div className=\"col-lg-8\" ><SearchBar /></div>\n\n                        <div className=\"col-lg-4\" style={{ cursor: 'pointer' }} >\n                            {/* <span style={{ float: 'right', lineHeight: '50px', marginLeft: '10px', color: '#3F51B5', fontSize: '16px', fontWeight: 'bolder' }}> */}\n                                <div className=\"d-flex justify-content-between\">\n                                <div className=\"btn\" style={{background:'#53a6e7'}} onClick={ex_rankingpage}>Excercise Ranking</div>\n                                <div onClick={() => setShow(!show)}><AddCircleIcon fontSize=\"large\" /> Add {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</div>\n                                </div>\n                            {/* </span> */}\n                        </div>\n                    </div>\n                </div><br /><br />\n\n                {/* header for the rows    */}\n                {/* <div className=\"container\"> */}\n                <div className=\"row\">\n                    <div className=\"col d-flex d-inline-flex\">\n\n                        <div className=\" pl-3 d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0 text-color-2\">Name</p>\n                        </div>\n\n\n                        <div className=\"d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0\">Email</p>\n                        </div>\n\n\n                        <div className=\" d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0\">Phone</p>\n                        </div>\n\n                    </div>\n                </div>\n                {/* </div> */}\n\n                {\n                    staff.map(st => {\n                        return (\n                            <>\n                                <div className=\"wrapper-list py-2 mt-2\" style={{backgroundColor:'#f5f5f5'}}>\n                                    <div className=\"container-fluid\">\n                                        <div className=\"row\">\n                                            <div className=\"col d-flex justify-content-between\">\n\n                                                <div className=\"d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-2 mb-0 text-color-2\">{st.fullname}</p>\n                                                </div>\n\n                                                <div className=\"d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-3 mb-0 \">{st.email}</p>\n                                                </div>\n\n                                                <div className=\"pr-2 d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-3 mb-0 text-color-2\">{st.phone}</p>\n                                                </div>\n                                                <div className=\"pr-2 d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-3 mb-0 text-color-2\">{st.tic}</p>\n                                                </div>\n\n                                                <div className=\"d-flex align-items-center ml-auto\">\n                                                    <Dropdown alignRight color={'red'} style={{backgroundColor:'#f5f5f5'}}>\n                                                        <Dropdown.Toggle id=\"dropdown-basic\" style={{ color: 'black', fontWeight: 'bolder'}}>\n                                                            ....\n                                                        </Dropdown.Toggle>\n                                                        <Dropdown.Menu>\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"view\">View Details</Dropdown.Item>\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"edit\">Edit {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"rate\">Rate {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>\n                                                            <Dropdown.Item onClick={() => alert('Hello')} data-current=\"delete\">Delete {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>\n                                                        </Dropdown.Menu>\n                                                    </Dropdown>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </>\n                        );\n                    })\n                }\n\n\n            </div>\n            <AddStaff show={show} onHide={() => setShow(!show)} closeModal={closeModal} />\n            <StaffDetails\n                show={showDetails}\n                onHide={() => setShowDetails(!showDetails)}\n                details={details}\n                spinner={spinner}\n            />\n            <Rating\n                show={showrating}\n                onHide={() => setShowRating(!showrating)}\n                details={details}\n                spinner={spinner}\n                closeModal={closeRating}\n                weeks={weeks}\n                lastDoc={lastDoc}\n\n            />\n            <Edit\n                show={showEdit}\n                onHide={() => setShowEdit(!showEdit)}\n                details={details}\n                spinner={spinner}\n                user={user}\n            />\n            <SchoolWeeks\n                show={schoolWeeksmodal}\n                onHide={() => setSchoolWeeksModal(!schoolWeeksmodal)}\n                getSchoolWeeks={getSchoolWeeks}\n            />\n        </>\n    );\n}\nexport default Staff;\n\n"]},"metadata":{},"sourceType":"module"}