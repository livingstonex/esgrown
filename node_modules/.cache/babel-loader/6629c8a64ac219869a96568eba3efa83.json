{"ast":null,"code":"import _objectSpread from \"/Users/mac/Desktop/projekte/esgrown/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/mac/Desktop/projekte/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/mac/Desktop/projekte/esgrown/src/components/corp_dashboard_components/staff/components/add-staff.js\";\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport md5 from 'md5';\nimport { Spinner, Modal } from 'react-bootstrap';\nimport DatePicker from \"react-datepicker\";\nimport { Card, CardContent } from '@material-ui/core';\nimport toast from '../../../../util/toast';\n\nconst AddStaff = ({\n  show,\n  onHide,\n  closeModal = () => {},\n  refreshStaff = () => {}\n}) => {\n  const _useState = useState({\n    name: '',\n    email: '',\n    gender: '',\n    password: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        data = _useState2[0],\n        setData = _useState2[1];\n\n  const _useState3 = useState(false),\n        _useState4 = _slicedToArray(_useState3, 2),\n        spinner = _useState4[0],\n        setSpinner = _useState4[1];\n\n  const _useState5 = useState(),\n        _useState6 = _slicedToArray(_useState5, 2),\n        user = _useState6[0],\n        setUser = _useState6[1];\n\n  useEffect(() => {\n    const user = JSON.parse(sessionStorage.getItem('key'));\n    setUser(user);\n  }, []);\n\n  const handleChange = e => {\n    const value = e.target.value;\n    const name = e.target.name;\n    setData(_objectSpread({}, data, {\n      [name]: value\n    }));\n  };\n\n  const notify = (message, type) => toast(message, type); //send data to server\n\n\n  const createUser = () => {\n    setSpinner(true);\n    const tic = user.org_type === 'school' ? md5(data.email).substring(0, 8).toUpperCase() : null;\n    const submitData = {\n      fullname: data.name,\n      email: data.email,\n      password: data.password,\n      gender: data.gender,\n      status: 'individual',\n      phone: null,\n      dob: new Date(),\n      country: null,\n      state: null,\n      org_type: user.org_type,\n      org_name: user.org_name,\n      org_id: user.id,\n      sub_status: 'inactive',\n      tic: tic\n    };\n    axios.post('http://localhost:5000/individuals/check_email', submitData).then(res => {\n      if (res.data.length > 0) {\n        if (res.data.org_name != null) {\n          const addExistinUser = window.confirm(\"A user with this email already exist. Would you like to add this user as your staff\");\n\n          if (addExistinUser) {\n            //get the details of the user with this email and populate the form field\n            axios.post('http://localhost:5000/individuals/add', submitData).then(res => {\n              if (res.data) {\n                notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success');\n                setSpinner(false);\n                closeModal();\n                refreshStaff();\n              }\n            }).catch(err => notify(err.message, 'error'));\n          }\n        }\n\n        notify(\"User with this email already exists\", \"warn\");\n        setData({\n          name: '',\n          email: '',\n          password: '',\n          gender: ''\n        });\n        setSpinner(false);\n      }\n\n      ;\n\n      if (res.data.length == 0) {\n        axios.post('http://localhost:5000/individuals/add', submitData).then(res => {\n          if (res.data) {\n            notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success');\n            setSpinner(false);\n            closeModal();\n            refreshStaff();\n          }\n        }).catch(err => notify(err.message, 'error'));\n      }\n\n      ;\n    }).catch(err => notify(err, 'error'));\n  };\n\n  return React.createElement(React.Fragment, null, React.createElement(Modal, {\n    show: show,\n    onHide: onHide,\n    centered: true,\n    style: {\n      marginTop: '50px'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    style: {\n      background: '#e9ecef'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\", \" Full Name\"), React.createElement(\"input\", {\n    type: \"text\",\n    name: \"name\",\n    value: data.name,\n    onChange: handleChange,\n    placeholder: \"Name\",\n    className: \"form-control\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, \"Email\"), React.createElement(\"input\", {\n    type: \"email\",\n    name: \"email\",\n    value: data.email,\n    onChange: handleChange,\n    placeholder: \"Email\",\n    className: \"form-control\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, \"Gender\"), React.createElement(\"select\", {\n    name: \"gender\",\n    onChange: handleChange,\n    className: \"form-control\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, \"Gender...\"), React.createElement(\"option\", {\n    value: \"male\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, \"Male\"), React.createElement(\"option\", {\n    value: \"female\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, \"Female\")))), React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    style: {\n      fontWeight: 'bold'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158\n    },\n    __self: this\n  }, \"Password\"), React.createElement(\"input\", {\n    type: \"password\",\n    name: \"password\",\n    value: data.password,\n    onChange: handleChange,\n    placeholder: \"Password...\",\n    className: \"form-control\",\n    required: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }))), React.createElement(Modal.Footer, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"btn mt-3 w-100 border-0\",\n    style: {\n      background: '#21A5E7',\n      color: 'white'\n    },\n    onClick: createUser,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, spinner ? React.createElement(Spinner, {\n    as: \"span\",\n    animation: \"grow\",\n    size: \"sm\",\n    role: \"status\",\n    \"aria-hidden\": \"true\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }) : `Add ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"}`)))))));\n};\n\nexport default AddStaff;","map":{"version":3,"sources":["/Users/mac/Desktop/projekte/esgrown/src/components/corp_dashboard_components/staff/components/add-staff.js"],"names":["React","useState","useEffect","axios","md5","Spinner","Modal","DatePicker","Card","CardContent","toast","AddStaff","show","onHide","closeModal","refreshStaff","name","email","gender","password","data","setData","spinner","setSpinner","user","setUser","JSON","parse","sessionStorage","getItem","handleChange","e","value","target","notify","message","type","createUser","tic","org_type","substring","toUpperCase","submitData","fullname","status","phone","dob","Date","country","state","org_name","org_id","id","sub_status","post","then","res","length","addExistinUser","window","confirm","catch","err","marginTop","background","fontWeight","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport md5 from 'md5';\nimport { Spinner, Modal } from 'react-bootstrap';\nimport DatePicker from \"react-datepicker\";\nimport { Card, CardContent } from '@material-ui/core';\nimport toast from '../../../../util/toast';\n\n\n\n\n\nconst AddStaff = ({ show, onHide, closeModal = () => { }, refreshStaff = () => { } }) => {\n\n\n\n    const [data, setData] = useState({\n        name: '',\n        email: '',\n        gender: '',\n        password: '',\n    });\n\n    const [spinner, setSpinner] = useState(false);\n\n    const [user, setUser] = useState();\n\n    useEffect(() => {\n        const user = JSON.parse(sessionStorage.getItem('key'));\n        setUser(user)\n    }, [])\n\n\n    const handleChange = (e) => {\n        const value = e.target.value;\n        const name = e.target.name;\n\n        setData({ ...data, [name]: value })\n    };\n\n    const notify = (message, type) => toast(message, type);\n\n\n    //send data to server\n    const createUser = () => {\n\n        setSpinner(true)\n\n        const tic = user.org_type === 'school' ? md5(data.email).substring(0, 8).toUpperCase() : null;\n\n\n        const submitData = {\n\n            fullname: data.name,\n            email: data.email,\n            password: data.password,\n            gender: data.gender,\n            status: 'individual',\n            phone: null,\n            dob: new Date(),\n            country: null,\n            state: null,\n            org_type: user.org_type,\n            org_name: user.org_name,\n            org_id: user.id,\n            sub_status: 'inactive',\n            tic: tic\n\n        }\n\n\n        axios.post('http://localhost:5000/individuals/check_email', submitData)\n            .then(res => {\n\n                if (res.data.length > 0) {\n\n                    if (res.data.org_name != null) {\n                        const addExistinUser = window.confirm(\"A user with this email already exist. Would you like to add this user as your staff\");\n\n                        if (addExistinUser) {\n                            //get the details of the user with this email and populate the form field\n                            axios.post('http://localhost:5000/individuals/add', submitData)\n                                .then(res => {\n                                    if (res.data) {\n                                        notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success')\n                                        setSpinner(false);\n                                        closeModal();\n                                        refreshStaff();\n                                    }\n                                })\n                                .catch(err => notify(err.message, 'error'));\n                        } \n                    }\n                    \n                        notify(\"User with this email already exists\", \"warn\");\n\n                    setData({\n                        name: '',\n                        email: '',\n                        password: '',\n                        gender: ''\n                    });\n                    setSpinner(false);\n                };\n                if (res.data.length == 0) {\n                    axios.post('http://localhost:5000/individuals/add', submitData)\n                        .then(res => {\n                            if (res.data) {\n                                notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success')\n                                setSpinner(false);\n                                closeModal();\n                                refreshStaff();\n                            }\n                        })\n                        .catch(err => notify(err.message, 'error'));\n\n                };\n            })\n            .catch(err => notify(err, 'error'));\n\n    }\n\n\n    return (\n        <>\n\n            <Modal show={show} onHide={onHide} centered style={{ marginTop: '50px', }}>\n\n                <div className=\"container\" style={{ background: '#e9ecef' }} >\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>{user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} Full Name</label>\n                            <input type=\"text\" name=\"name\" value={data.name} onChange={handleChange} placeholder=\"Name\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Email</label>\n                            <input type=\"email\" name=\"email\" value={data.email} onChange={handleChange} placeholder=\"Email\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Gender</label>\n                            <select name=\"gender\" onChange={handleChange} className=\"form-control\">\n                                <option>Gender...</option>\n                                <option value=\"male\">Male</option>\n                                <option value=\"female\">Female</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Password</label>\n                            <input type=\"password\" name=\"password\" value={data.password} onChange={handleChange} placeholder=\"Password...\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n\n                    <Modal.Footer>\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    className=\"btn mt-3 w-100 border-0\"\n                                    style={{ background: '#21A5E7', color: 'white' }}\n                                    onClick={createUser}\n                                >\n                                    {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : `Add ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"}`}\n                                </button>\n                            </div>\n                        </div>\n                    </Modal.Footer>\n                </div>\n\n            </Modal>\n        </>\n    );\n}\nexport default AddStaff;"]},"metadata":{},"sourceType":"module"}