{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,Fragment}from'react';import{Modal,Spinner}from'react-bootstrap/';import PayStackButton from'../paystack/paystackpaymentbutton';import axios from'axios';export default function Form(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),modalShow=_useState2[0],setModalShow=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),spinner=_useState4[0],setSpinner=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),HLE=_useState6[0],setHLE=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),NOWP=_useState8[0],setNOWP=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),subPlan=_useState10[0],setSubPlan=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),amount=_useState12[0],setAmount=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),modalPayShow=_useState14[0],setModalPayShow=_useState14[1];var _useState15=useState(\"\"),_useState16=_slicedToArray(_useState15,2),useremail=_useState16[0],setUserEmail=_useState16[1];var _useState17=useState(\"\"),_useState18=_slicedToArray(_useState17,2),userId=_useState18[0],setUserId=_useState18[1];var _useState19=useState(false),_useState20=_slicedToArray(_useState19,2),subStatus=_useState20[0],setSubStatus=_useState20[1];var _useState21=useState(0),_useState22=_slicedToArray(_useState21,2),button=_useState22[0],setButton=_useState22[1];var onChangeHLE=function onChangeHLE(e){setHLE(e.target.value);};var onChangeNOWP=function onChangeNOWP(e){setNOWP(e.target.value);};var onChangePlan=function onChangePlan(e){var plan=e.target.value.split('/');setSubPlan(plan[0]);setAmount(plan[1]);console.log(plan);};var onSubmit=function onSubmit(e){e.preventDefault();var SubObject={user_id:props.user.id,sub_status:false,user_name:props.user.name,user_email:props.user.email,user_status:props.user.status,highest_level_of_education:HLE,nature_of_work_business:NOWP};try{setSpinner(true);axios.post('http://localhost:5000/subscriptionlm/add',SubObject).then(function(res){console.log(res.data);setSpinner(false);setModalShow(false);setModalPayShow(true);}).catch(function(err){console.log('Err: '+err);setSpinner(false);setModalShow(false);});}catch(error){console.log(error);setSpinner(false);setModalShow(false);}};//GET LOGGEDIN USER CREDENTIALS FOR PMT\nuseEffect(function(){var userData=JSON.parse(sessionStorage.getItem('key'));var userEmail=userData.email;var userId=userData.id;setUserEmail(userEmail);setUserId(userId);//get sub status for user\n// axios.get(`http://localhost:5000/subscriptionlm/${userData.id}`)\n//     .then(res => {\n//         if (res.data[0].ref != null) {\n//             // setSubStatus(res.data[0].sub_status);\n//             setButton(1);\n//         } else {\n//             setButton(2);\n//         }\n//     })\n//     .catch(err => console.log(err))\nif(userData.sub_status_lm==='active'){setSubStatus(userData.sub_status_lm);setButton(1);}else{setButton(2);}},[]);//Paystack Functions\nvar onSuccess=function onSuccess(res){console.log(res);setModalPayShow(false);//make a call to https://api.paystack.co/subscription and get all subscription \n//and filter for email of current subscription and extract subscription code.\n//update individual doc with the gotten data.\naxios.get(\"https://api.paystack.co/subscription\",{headers:{\"Authorization\":\"Bearer sk_test_19f4c12e4e018a9f742e1723d42c9c8e509800b4\"}}).then(function(res){var client=res.data.data.filter(function(st){return st.customer.email===useremail;});var data={ref:res.reference,sub_status:client[0].status,sub_code:client[0].subscription_code};//update eas substatus\naxios.post(\"http://localhost:5000/subscriptionlm/update/lmref/\".concat(userId),data).then(function(res){return console.log(res);}).catch(function(err){return console.log(err);});//update user details\naxios.post(\"http://localhost:5000/individuals/update/substatus/\".concat(userId),{sub_status_lm:client[0].status}).then(function(res){var globalUser=JSON.parse(sessionStorage.getItem('key'));globalUser.sub_status_lm=client[0].status;sessionStorage.setItem('key',JSON.stringify(globalUser));setButton(1);}).catch(function(err){return console.log(err);});}).catch(function(err){return console.log(err);});};var close=function close(){console.log(\"Payment closed\");setModalPayShow(false);};return React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"ml-auto d-flex align-items-center\"},React.createElement(React.Fragment,null,button===1?React.createElement(\"button\",{className:\"btn btn-info btn-sm\",disabled:true,style:{color:'white',background:'#97ba0d',border:'#97ba0d'}},\"Subscribed\"):button===2?React.createElement(\"button\",{className:\"btn btn-info btn-sm\",onClick:function onClick(){return setModalShow(true);}},\"Subscribe\"):React.createElement(\"button\",{className:\"btn btn-info btn-sm\",onClick:function onClick(){return setModalShow(true);}},\"Subscribe\"))),React.createElement(Modal,{show:modalShow,onHide:function onHide(){return setModalShow(false);},\"aria-labelledby\":\"example-custom-modal-styling-title\",centered:true},React.createElement(Modal.Body,null,React.createElement(\"form\",{className:\"container py-4\",onSubmit:onSubmit},React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"h6\",null,\"Subscription Details\"))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"select\",{className:\"form-control\",required:true,onChange:onChangeHLE},React.createElement(\"option\",null,\"Level of Education\"),React.createElement(\"option\",{value:\"degree\"},\"Degree\"),React.createElement(\"option\",{value:\"masters\"},\"Masters\"),React.createElement(\"option\",{value:\"phd\"},\"Ph.D\")))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"textarea\",{value:NOWP,onChange:onChangeNOWP,rows:\"7\",className:\"form-control\",required:true,placeholder:\"Nature of Work or Business\"}))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"select\",{className:\"form-control\",required:true,onChange:onChangePlan},React.createElement(\"option\",null,\"Select Subscription Plan\"),React.createElement(\"option\",{value:\"PLN_hwug5s75tf2rcqu/289000\"},\"Quarterly (three Months)\"),React.createElement(\"option\",{value:\"PLN_072a7glz3tv6fzi/455000\"},\"Biannual (six Months)\"),React.createElement(\"option\",{value:\"PLN_wma6tld3z1g2zef/797000\"},\"Annual (one Year)\")))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"button\",{type:\"submit\",className:\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\",disabled:spinner},\"Proceed  \",spinner?React.createElement(Spinner,{as:\"span\",animation:\"grow\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}):\"\")))))),React.createElement(PayStackButton,{show:modalPayShow,onHide:function onHide(){return setModalPayShow(false);},close:close,callback:onSuccess,email:useremail,amount:amount,plan:subPlan}));}","map":{"version":3,"sources":["/Users/mac/Desktop/esgrown/src/components/ind_dashboard_components/subscription-forms/lm-form.js"],"names":["React","useState","useEffect","Fragment","Modal","Spinner","PayStackButton","axios","Form","props","modalShow","setModalShow","spinner","setSpinner","HLE","setHLE","NOWP","setNOWP","subPlan","setSubPlan","amount","setAmount","modalPayShow","setModalPayShow","useremail","setUserEmail","userId","setUserId","subStatus","setSubStatus","button","setButton","onChangeHLE","e","target","value","onChangeNOWP","onChangePlan","plan","split","console","log","onSubmit","preventDefault","SubObject","user_id","user","id","sub_status","user_name","name","user_email","email","user_status","status","highest_level_of_education","nature_of_work_business","post","then","res","data","catch","err","error","userData","JSON","parse","sessionStorage","getItem","userEmail","sub_status_lm","onSuccess","get","headers","client","filter","st","customer","ref","reference","sub_code","subscription_code","globalUser","setItem","stringify","close","color","background","border"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from 'react';\nimport { Modal, Spinner } from 'react-bootstrap/';\nimport PayStackButton from '../paystack/paystackpaymentbutton';\nimport axios from 'axios';\n\n\nexport default function Form(props) {\n\n    const [modalShow, setModalShow] = useState(false);\n    const [spinner, setSpinner] = useState(false);\n    const [HLE, setHLE] = useState(\"\");\n    const [NOWP, setNOWP] = useState(\"\");\n\n    const [subPlan, setSubPlan] = useState(\"\");\n    const [amount, setAmount] = useState(\"\");\n    const [modalPayShow, setModalPayShow] = useState(false);\n    const [useremail, setUserEmail] = useState(\"\");\n    const [userId, setUserId] = useState(\"\");\n    const [subStatus, setSubStatus] = useState(false);\n    const [button, setButton] = useState(0)\n\n\n\n\n    const onChangeHLE = (e) => {\n        setHLE(e.target.value);\n    }\n\n    const onChangeNOWP = (e) => {\n        setNOWP(e.target.value);\n    }\n\n    const onChangePlan = (e) => {\n        const plan = e.target.value.split('/');\n        setSubPlan(plan[0]);\n        setAmount(plan[1]);\n        console.log(plan)\n    }\n\n    const onSubmit = (e) => {\n        e.preventDefault();\n\n        const SubObject = {\n            user_id: props.user.id,\n            sub_status: false,\n            user_name: props.user.name,\n            user_email: props.user.email,\n            user_status: props.user.status,\n            highest_level_of_education: HLE,\n            nature_of_work_business: NOWP\n        }\n\n        try {\n            setSpinner(true);\n            axios.post('http://localhost:5000/subscriptionlm/add', SubObject)\n                .then((res) => {\n                    console.log(res.data);\n                    setSpinner(false);\n                    setModalShow(false);\n                    setModalPayShow(true);\n\n                })\n                .catch(err => {\n                    console.log('Err: ' + err);\n                    setSpinner(false);\n                    setModalShow(false);\n                });\n        } catch (error) {\n            console.log(error);\n            setSpinner(false);\n            setModalShow(false);\n        }\n\n    }\n\n    //GET LOGGEDIN USER CREDENTIALS FOR PMT\n    useEffect(() => {\n        const userData = JSON.parse(sessionStorage.getItem('key'));\n        const userEmail = userData.email;\n        const userId = userData.id;\n        setUserEmail(userEmail);\n        setUserId(userId);\n\n        //get sub status for user\n        // axios.get(`http://localhost:5000/subscriptionlm/${userData.id}`)\n        //     .then(res => {\n        //         if (res.data[0].ref != null) {\n        //             // setSubStatus(res.data[0].sub_status);\n        //             setButton(1);\n        //         } else {\n        //             setButton(2);\n        //         }\n        //     })\n        //     .catch(err => console.log(err))\n        if (userData.sub_status_lm === 'active') {\n\n            setSubStatus(userData.sub_status_lm);\n            setButton(1);\n\n        } else {\n            setButton(2);\n        }\n\n    }, [])\n\n    //Paystack Functions\n    const onSuccess = (res) => {\n        console.log(res);\n        setModalPayShow(false);\n\n        //make a call to https://api.paystack.co/subscription and get all subscription \n        //and filter for email of current subscription and extract subscription code.\n        //update individual doc with the gotten data.\n\n        axios.get(`https://api.paystack.co/subscription`, { headers: { \"Authorization\": \"Bearer sk_test_19f4c12e4e018a9f742e1723d42c9c8e509800b4\" } })\n            .then(res => {\n                const client = res.data.data.filter(st => {\n                    return st.customer.email === useremail\n                })\n\n                const data = {\n                    ref: res.reference,\n                    sub_status: client[0].status,\n                    sub_code: client[0].subscription_code\n                }\n\n                //update eas substatus\n                axios.post(`http://localhost:5000/subscriptionlm/update/lmref/${userId}`, data)\n                    .then(res => console.log(res))\n                    .catch(err => console.log(err))\n\n\n                //update user details\n                axios.post(`http://localhost:5000/individuals/update/substatus/${userId}`, { sub_status_lm: client[0].status, })\n                    .then(res => {\n                        const globalUser = JSON.parse(sessionStorage.getItem('key'));\n\n                        globalUser.sub_status_lm = client[0].status;\n\n                        sessionStorage.setItem('key', JSON.stringify(globalUser));\n                        setButton(1)\n\n                    }).catch(err => console.log(err))\n\n            }).catch(err => console.log(err));\n\n\n    }\n\n    const close = () => {\n        console.log(\"Payment closed\");\n        setModalPayShow(false)\n    }\n    return (\n        <React.Fragment>\n            <div className=\"ml-auto d-flex align-items-center\">\n                <React.Fragment>\n                    {(button === 1) ? <button className=\"btn btn-info btn-sm\" disabled style={{ color: 'white', background: '#97ba0d', border: '#97ba0d' }}>Subscribed</button> : (button === 2) ? <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button> : <button className=\"btn btn-info btn-sm\" onClick={() => setModalShow(true)}>Subscribe</button>}\n                </React.Fragment>\n\n            </div>\n            <Modal\n                show={modalShow}\n                onHide={() => setModalShow(false)}\n                aria-labelledby=\"example-custom-modal-styling-title\"\n                centered\n            >\n                <Modal.Body>\n                    <form className=\"container py-4\" onSubmit={onSubmit} >\n                        <div className=\"row\">\n                            <div className=\"col\">\n                                <h6>Subscription Details</h6>\n                            </div>\n                        </div>\n                        {/* Level of Education */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangeHLE}>\n                                    <option>Level of Education</option>\n                                    <option value=\"degree\">Degree</option>\n                                    <option value=\"masters\">Masters</option>\n                                    <option value=\"phd\">Ph.D</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* Intended Study field */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <textarea value={NOWP} onChange={onChangeNOWP} rows='7' className=\"form-control\" required placeholder=\"Nature of Work or Business\">\n\n                                </textarea>\n                            </div>\n                        </div>\n                        {/* Subscription Plan */}\n\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <select className=\"form-control\" required onChange={onChangePlan}>\n                                    <option>Select Subscription Plan</option>\n                                    <option value=\"PLN_hwug5s75tf2rcqu/289000\">Quarterly (three Months)</option>\n                                    <option value=\"PLN_072a7glz3tv6fzi/455000\">Biannual (six Months)</option>\n                                    <option value=\"PLN_wma6tld3z1g2zef/797000\">Annual (one Year)</option>\n                                </select>\n                            </div>\n                        </div>\n\n                        {/* submit button */}\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    type=\"submit\"\n                                    className=\"btn font-weight-light btn-primary mt-3 py-2 w-100 border-0\"\n                                    disabled={spinner}\n                                >Proceed  {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : \"\"}\n                                </button>\n                            </div>\n                        </div>\n                    </form>\n                </Modal.Body>\n            </Modal>\n            <PayStackButton\n                show={modalPayShow}\n                onHide={() => setModalPayShow(false)}\n                close={close}\n                callback={onSuccess}\n                email={useremail}\n                amount={amount}\n                plan={subPlan}\n            />\n        </React.Fragment>\n    );\n}"]},"metadata":{},"sourceType":"module"}