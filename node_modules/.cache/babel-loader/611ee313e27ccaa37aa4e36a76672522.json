{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require(\"react\");\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require(\"prop-types\");\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar PayStack = function (_Component) {\n  _inherits(PayStack, _Component);\n\n  function PayStack(props) {\n    _classCallCheck(this, PayStack);\n\n    var _this = _possibleConstructorReturn(this, (PayStack.__proto__ || Object.getPrototypeOf(PayStack)).call(this, props));\n\n    _this.payWithPaystack = _this.payWithPaystack.bind(_this);\n    _this.loadScript = _this.loadScript.bind(_this);\n    _this.loadscriptAndUpdateState = _this.loadscriptAndUpdateState.bind(_this);\n    _this.state = _extends({}, _this.props, {\n      scriptLoaded: null,\n      class: _this.props.class || _this.props.className || \"\"\n    });\n    return _this;\n  }\n\n  _createClass(PayStack, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadscriptAndUpdateState();\n    }\n  }, {\n    key: \"loadscriptAndUpdateState\",\n    value: function loadscriptAndUpdateState() {\n      var _this2 = this;\n\n      this.setState({\n        scriptLoaded: new Promise(function (resolve) {\n          _this2.loadScript(function () {\n            resolve();\n          });\n        })\n      }, function () {\n        if (_this2.props.embed) {\n          _this2.payWithPaystack();\n        }\n      });\n    }\n  }, {\n    key: \"loadScript\",\n    value: function loadScript(callback) {\n      var script = document.createElement(\"script\");\n      script.src = \"https://js.paystack.co/v1/inline.js\";\n      document.getElementsByTagName(\"head\")[0].appendChild(script);\n\n      if (script.readyState) {\n        // IE\n        script.onreadystatechange = function () {\n          if (script.readyState === \"loaded\" || script.readyState === \"complete\") {\n            script.onreadystatechange = null;\n            callback();\n          }\n        };\n      } else {\n        // Others\n        script.onload = function () {\n          callback();\n        };\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      for (var index in prevProps) {\n        if (prevState[index] !== this.state[index]) {\n          this.loadscriptAndUpdateState();\n        }\n      }\n    }\n  }, {\n    key: \"payWithPaystack\",\n    value: function payWithPaystack() {\n      var _this3 = this;\n\n      this.state.scriptLoaded && this.state.scriptLoaded.then(function () {\n        console.log('ref:', _this3.state.reference);\n        var paystackOptions = {\n          key: _this3.state.paystackkey,\n          email: _this3.state.email,\n          amount: _this3.state.amount,\n          ref: _this3.state.reference,\n          metadata: _this3.state.metadata || {},\n          callback: function callback(response) {\n            _this3.state.callback(response);\n          },\n          onClose: function onClose() {\n            _this3.state.close();\n          },\n          currency: _this3.state.currency,\n          plan: _this3.state.plan || \"\",\n          quantity: _this3.state.quantity || \"\",\n          subaccount: _this3.state.subaccount || \"\",\n          transaction_charge: _this3.state.transaction_charge || 0,\n          bearer: _this3.state.bearer || \"\"\n        };\n\n        if (_this3.state.embed) {\n          paystackOptions.container = \"paystackEmbedContainer\";\n        }\n\n        var handler = window.PaystackPop.setup(paystackOptions);\n\n        if (!_this3.state.embed) {\n          handler.openIframe();\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var CustomTag = \"\" + this.props.tag;\n      return this.props.embed ? _react2.default.createElement(\"div\", {\n        id: \"paystackEmbedContainer\"\n      }) : _react2.default.createElement(_react.Fragment, null, _react2.default.createElement(CustomTag, {\n        className: this.state.class,\n        onClick: this.payWithPaystack,\n        disabled: this.state.disabled\n      }, this.state.text));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      for (var index in nextProps) {\n        if (nextProps[index] !== prevState[index]) {\n          return _defineProperty({\n            scriptLoaded: null\n          }, index, nextProps[index]);\n        }\n      }\n\n      return null;\n    }\n  }]);\n\n  return PayStack;\n}(_react.Component);\n\nPayStack.propTypes = {\n  embed: _propTypes2.default.bool,\n  text: _propTypes2.default.string,\n  class: _propTypes2.default.string,\n  metadata: _propTypes2.default.object,\n  currency: _propTypes2.default.string,\n  plan: _propTypes2.default.string,\n  quantity: _propTypes2.default.string,\n  subaccount: _propTypes2.default.string,\n  transaction_charge: _propTypes2.default.number,\n  bearer: _propTypes2.default.string,\n  reference: _propTypes2.default.string.isRequired,\n  email: _propTypes2.default.string.isRequired,\n  amount: _propTypes2.default.number.isRequired,\n  //in kobo\n  paystackkey: _propTypes2.default.string.isRequired,\n  callback: _propTypes2.default.func.isRequired,\n  close: _propTypes2.default.func.isRequired,\n  disabled: _propTypes2.default.bool,\n  tag: _propTypes2.default.oneOf(['button', 'a', 'input'])\n};\nPayStack.defaultProps = {\n  tag: 'button',\n  text: \"Make Payment\",\n  currency: \"NGN\",\n  disabled: false\n};\nexports.default = PayStack;","map":{"version":3,"sources":["../src/PayStack.js"],"names":[],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\n\nclass PayStack extends Component {\n  constructor(props) {\n    super(props);\n    this.payWithPaystack = this.payWithPaystack.bind(this);\n    this.loadScript = this.loadScript.bind(this);\n    this.loadscriptAndUpdateState = this.loadscriptAndUpdateState.bind(this);\n    this.state = {\n      ...this.props,\n      scriptLoaded: null,\n      class: this.props.class || this.props.className || \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.loadscriptAndUpdateState()\n  }\n\n  loadscriptAndUpdateState() {\n    this.setState(\n      {\n        scriptLoaded: new Promise(resolve => {\n          this.loadScript(() => {\n            resolve();\n          });\n        })\n      },\n      () => {\n        if (this.props.embed) {\n          this.payWithPaystack();\n        }\n      }\n    );\n  }\n\n  loadScript(callback) {\n    const script = document.createElement(\"script\");\n    script.src = \"https://js.paystack.co/v1/inline.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n    if (script.readyState) {\n      // IE\n      script.onreadystatechange = () => {\n        if (\n          script.readyState === \"loaded\" ||\n          script.readyState === \"complete\"\n        ) {\n          script.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      // Others\n      script.onload = () => {\n        callback();\n      };\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    for (const index in prevProps) {\n      if (prevState[index] !== this.state[index]) {\n        this.loadscriptAndUpdateState()\n      }\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    for (const index in nextProps) {\n      if (nextProps[index] !== prevState[index]) {\n        return {\n          scriptLoaded: null,\n          [index]: nextProps[index]\n        }\n      }\n    }\n\n    return null;\n  }\n\n  payWithPaystack() {\n    this.state.scriptLoaded &&\n      this.state.scriptLoaded.then(() => {\n        console.log('ref:', this.state.reference)\n        let paystackOptions = {\n          key: this.state.paystackkey,\n          email: this.state.email,\n          amount: this.state.amount,\n          ref: this.state.reference,\n          metadata: this.state.metadata || {},\n          callback: response => {\n            this.state.callback(response);\n          },\n          onClose: () => {\n            this.state.close();\n          },\n          currency: this.state.currency,\n          plan: this.state.plan || \"\",\n          quantity: this.state.quantity || \"\",\n          subaccount: this.state.subaccount || \"\",\n          transaction_charge: this.state.transaction_charge || 0,\n          bearer: this.state.bearer || \"\",\n        };\n        if (this.state.embed) {\n          paystackOptions.container = \"paystackEmbedContainer\";\n        }\n        const handler = window.PaystackPop.setup(paystackOptions);\n        if (!this.state.embed) {\n          handler.openIframe();\n        }\n      });\n  }\n\n  render() {\n    const CustomTag = `${this.props.tag}`;\n    return this.props.embed ? (\n      <div id=\"paystackEmbedContainer\" />\n    ) : (\n      <Fragment>\n        <CustomTag\n          className={this.state.class}\n          onClick={this.payWithPaystack}\n          disabled={this.state.disabled}\n        >\n          {this.state.text}\n        </CustomTag>\n      </Fragment>\n    );\n  }\n}\n\nPayStack.propTypes = {\n  embed: PropTypes.bool,\n  text: PropTypes.string,\n  class: PropTypes.string,\n  metadata: PropTypes.object,\n  currency: PropTypes.string,\n  plan: PropTypes.string,\n  quantity: PropTypes.string,\n  subaccount: PropTypes.string,\n  transaction_charge: PropTypes.number,\n  bearer: PropTypes.string,\n  reference: PropTypes.string.isRequired,\n  email: PropTypes.string.isRequired,\n  amount: PropTypes.number.isRequired, //in kobo\n  paystackkey: PropTypes.string.isRequired,\n  callback: PropTypes.func.isRequired,\n  close: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  tag: PropTypes.oneOf(['button', 'a', 'input']),\n};\n\nPayStack.defaultProps = {\n  tag: 'button',\n  text: \"Make Payment\",\n  currency: \"NGN\",\n  disabled: false\n};\n\nexport default PayStack;\n"]},"metadata":{},"sourceType":"script"}