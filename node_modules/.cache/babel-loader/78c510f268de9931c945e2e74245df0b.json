{"ast":null,"code":"import _slicedToArray from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import{Spinner,Dropdown,EditModal}from'react-bootstrap';import AddCircleIcon from'@material-ui/icons/AddCircle';import SearchBar from'../job/components/search';import AddStaff from'./components/add-staff';import StaffDetails from'./components/details';import Rating from'./components/teacher-rateing';import Edit from'./components/edit';import SchoolWeeks from'./components/school-weeks';import CompanyStaffRating from'./components/staff-rating';import toast from'../../../util/toast';import'./styles.css';import DeleteStaff from'./components/delete';var Staff=function Staff(_ref){var ex_rankingpage=_ref.ex_rankingpage;var _useState=useState(),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),show=_useState4[0],setShow=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),staff=_useState6[0],setStaff=_useState6[1];//modals\nvar _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showDetails=_useState8[0],setShowDetails=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showrating=_useState10[0],setShowRating=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),showEdit=_useState12[0],setShowEdit=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),schoolWeeksmodal=_useState14[0],setSchoolWeeksModal=_useState14[1];var _useState15=useState([]),_useState16=_slicedToArray(_useState15,2),details=_useState16[0],setDetails=_useState16[1];var _useState17=useState(true),_useState18=_slicedToArray(_useState17,2),spinner=_useState18[0],setSpinner=_useState18[1];var _useState19=useState(),_useState20=_slicedToArray(_useState19,2),weeks=_useState20[0],setWeeks=_useState20[1];var _useState21=useState([]),_useState22=_slicedToArray(_useState21,2),lastDoc=_useState22[0],setLastDoc=_useState22[1];var _useState23=useState(),_useState24=_slicedToArray(_useState23,2),target=_useState24[0],setTarget=_useState24[1];var _useState25=useState(false),_useState26=_slicedToArray(_useState25,2),showDelete=_useState26[0],setShowDelete=_useState26[1];var _useState27=useState(false),_useState28=_slicedToArray(_useState27,2),ratecompany=_useState28[0],setRateCompany=_useState28[1];useEffect(function(){var user=JSON.parse(sessionStorage.getItem('key'));setUser(user);axios.get(\"http://localhost:5000/individuals/staff/\".concat(user.id)).then(function(res){if(res.data.length>0){setStaff(res.data);}}).catch(function(err){return console.log(err);});//check if this is the beginning of the term and get the total weeks for the term\naxios.get(\"http://localhost:5000/rate/teacher/check/\".concat(user.org_name)).then(function(res){setLastDoc(res.data.reverse()[0]);}).catch(function(err){return console.log(err);});},[]);//get the new school week and show rating modal\nvar getSchoolWeeks=function getSchoolWeeks(w){setWeeks(w);setSchoolWeeksModal(false);displayDetails(target);};//close add modal and reload staff\nvar closeModal=function closeModal(){setShow(false);setShowEdit(false);axios.get(\"http://localhost:5000/individuals/staff/\".concat(user.id)).then(function(res){if(res.data.length>0){setStaff(res.data);}}).catch(function(err){return console.log(err);});};//get currently clicked staff\nvar getDetails=function getDetails(e){setTarget(e.currentTarget);var current=e.target.getAttribute('data-current');//show company rating modal\nif(current==='rate'&&user.org_type==='company'){var id=e.target.getAttribute('data-id');var staffDetails=staff.filter(function(st){return st._id===id;});setDetails(staffDetails[0]);setRateCompany(true);}else{if(current==='rate'){if(lastDoc===undefined){setTarget(e.currentTarget);setSchoolWeeksModal(true);toast(\"Please tell us how many weeks are in your calendar this term\",\"info\");return;}else if(lastDoc.total_weeks===lastDoc.current_week){setTarget(e.currentTarget);setSchoolWeeksModal(true);toast(\"your Current Term has ended. Please start a new term\",\"info\");return;}}displayDetails(target,e);}};//display modal based on selected action\nvar displayDetails=function displayDetails(target,e){var id=e?e.target.getAttribute('data-id'):target.getAttribute('data-id');var current=e?e.target.getAttribute('data-current'):target.getAttribute('data-current');var loadModal=function loadModal(){return current===\"view\"?setShowDetails(true):current===\"rate\"?setShowRating(true):current===\"edit\"?setShowEdit(true):current===\"delete\"?setShowDelete(true):\"\";};var staffDetails=staff.filter(function(st){return st._id===id;});setDetails(staffDetails[0]);loadModal();};var closeRating=function closeRating(){setShowRating(false);setRateCompany(false);};console.log(staff);// const status_color = \nreturn React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"container\",style:{marginTop:\"70px\"}},React.createElement(\"div\",{className:\"container\"},React.createElement(\"div\",{className:\"row d-flex align-items-center justify-content-center\",style:{background:'#C4C4C4',padding:'10px'}},React.createElement(\"div\",{className:\"col-lg-8\"},React.createElement(SearchBar,null)),React.createElement(\"div\",{className:\"col-lg-4\",style:{cursor:'pointer'}},React.createElement(\"div\",{className:\"d-flex justify-content-between\"},React.createElement(\"div\",{className:\"btn\",style:{background:'lightgrey'},onClick:ex_rankingpage},\"Excercise Ranking\"),React.createElement(\"div\",{className:\"btn\",style:{background:'lightgrey'},onClick:function onClick(){return setShow(!show);}},\"Add \",user&&user.org_type===\"school\"?\"teacher\":\"staff\"))))),React.createElement(\"br\",null),React.createElement(\"br\",null),React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col d-flex d-inline-flex\"},React.createElement(\"div\",{className:\" pl-3 d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"mb-0 text-color-2\"},\"Name\")),React.createElement(\"div\",{className:\"d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"mb-0\"},\"Email\")),React.createElement(\"div\",{className:\" d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"mb-0\"},\"Phone\")),React.createElement(\"div\",{className:\" d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"mb-0\"},\"Status\")))),staff.map(function(st){return React.createElement(React.Fragment,null,React.createElement(\"div\",{className:\"wrapper-list py-2 mt-2\",style:{backgroundColor:'#f5f5f5'}},React.createElement(\"div\",{className:\"container-fluid\"},React.createElement(\"div\",{className:\"row\"},React.createElement(\"div\",{className:\"col d-flex justify-content-between\"},React.createElement(\"div\",{className:\"d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"ml-2 mb-0 text-color-2\"},st.fullname)),React.createElement(\"div\",{className:\"d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"ml-3 mb-0 \"},st.email)),React.createElement(\"div\",{className:\"pr-2 d-flex flex-fill align-items-center\"},React.createElement(\"p\",{className:\"ml-3 mb-0 text-color-2\"},st.phone)),React.createElement(\"div\",{className:\"pr-2 d-flex flex-fill align-items-center\"},st.sub_status_compt_mgt=='active'?React.createElement(\"p\",{className:\"ml-3 mb-0 text-color-2 badge badge-success\"},st.sub_status_compt_mgt):st.sub_status_compt_mgt=='inactive'?React.createElement(\"p\",{className:\"ml-3 mb-0 text-color-2 badge badge-danger\"},st.sub_status_compt_mgt):React.createElement(\"p\",{className:\"ml-3 mb-0 text-color-2 badge badge-info\"},st.sub_status_compt_mgt)),React.createElement(\"div\",{className:\"d-flex align-items-center ml-auto\"},React.createElement(Dropdown,{alignRight:true,color:'red',style:{backgroundColor:'#f5f5f5'}},React.createElement(Dropdown.Toggle,{id:\"dropdown-basic\",style:{color:'black',fontWeight:'bolder'}},\"....\"),React.createElement(Dropdown.Menu,null,React.createElement(Dropdown.Item,{onClick:getDetails,\"data-id\":st._id,\"data-current\":\"view\"},\"View Details\"),React.createElement(Dropdown.Item,{onClick:getDetails,\"data-id\":st._id,\"data-current\":\"edit\"},\"Edit \",user&&user.org_type===\"school\"?\"teacher\":\"staff\"),st.sub_status_compt_mgt=='active'?React.createElement(Dropdown.Item,{onClick:getDetails,\"data-id\":st._id,\"data-current\":\"rate\"},\"Rate \",user&&user.org_type===\"school\"?\"teacher\":\"staff\"):React.createElement(Dropdown.Item,{disabled:true},\"Rate \",user&&user.org_type===\"school\"?\"teacher\":\"staff\"),React.createElement(Dropdown.Item,{onClick:getDetails,\"data-id\":st._id,\"data-current\":\"delete\"},\"Delete \",user&&user.org_type===\"school\"?\"teacher\":\"staff\")))))))));})),React.createElement(AddStaff,{show:show,onHide:function onHide(){return setShow(!show);},closeModal:closeModal}),React.createElement(StaffDetails,{show:showDetails,onHide:function onHide(){return setShowDetails(!showDetails);},details:details,spinner:spinner}),React.createElement(Rating,{show:showrating,onHide:function onHide(){return setShowRating(!showrating);},details:details,spinner:spinner,closeModal:closeRating,weeks:weeks,lastDoc:lastDoc}),React.createElement(Edit,{show:showEdit,onHide:function onHide(){return setShowEdit(!showEdit);},id:details._id,spinner:spinner,user:user,closeModal:closeModal}),React.createElement(SchoolWeeks,{show:schoolWeeksmodal,onHide:function onHide(){return setSchoolWeeksModal(!schoolWeeksmodal);},getSchoolWeeks:getSchoolWeeks}),React.createElement(CompanyStaffRating,{show:ratecompany,onHide:function onHide(){return setRateCompany(!ratecompany);},details:details,closeModal:closeRating}),React.createElement(DeleteStaff,{show:showDelete,onHide:function onHide(){return setShowDelete(!showDelete);},details:details,user:user}));};export default Staff;","map":{"version":3,"sources":["/Users/mac/Desktop/esgrown/src/components/corp_dashboard_components/staff/staff.js"],"names":["React","useState","useEffect","axios","Spinner","Dropdown","EditModal","AddCircleIcon","SearchBar","AddStaff","StaffDetails","Rating","Edit","SchoolWeeks","CompanyStaffRating","toast","DeleteStaff","Staff","ex_rankingpage","user","setUser","show","setShow","staff","setStaff","showDetails","setShowDetails","showrating","setShowRating","showEdit","setShowEdit","schoolWeeksmodal","setSchoolWeeksModal","details","setDetails","spinner","setSpinner","weeks","setWeeks","lastDoc","setLastDoc","target","setTarget","showDelete","setShowDelete","ratecompany","setRateCompany","JSON","parse","sessionStorage","getItem","get","id","then","res","data","length","catch","err","console","log","org_name","reverse","getSchoolWeeks","w","displayDetails","closeModal","getDetails","e","currentTarget","current","getAttribute","org_type","staffDetails","filter","st","_id","undefined","total_weeks","current_week","loadModal","closeRating","marginTop","background","padding","cursor","map","backgroundColor","fullname","email","phone","sub_status_compt_mgt","color","fontWeight"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { Spinner, Dropdown, EditModal } from 'react-bootstrap';\nimport AddCircleIcon from '@material-ui/icons/AddCircle';\nimport SearchBar from '../job/components/search';\nimport AddStaff from './components/add-staff';\nimport StaffDetails from './components/details';\nimport Rating from './components/teacher-rateing';\nimport Edit from './components/edit';\nimport SchoolWeeks from './components/school-weeks';\nimport CompanyStaffRating from './components/staff-rating';\nimport toast from '../../../util/toast';\nimport './styles.css';\nimport DeleteStaff from './components/delete';\n\n\n\nconst Staff = ({ex_rankingpage}) => {\n\n\n    const [user, setUser] = useState();\n    const [show, setShow] = useState(false);\n    const [staff, setStaff] = useState([]);\n\n    //modals\n    const [showDetails, setShowDetails] = useState(false);\n    const [showrating, setShowRating] = useState(false)\n    const [showEdit, setShowEdit] = useState(false);\n    const [schoolWeeksmodal, setSchoolWeeksModal] = useState(false);\n\n\n    const [details, setDetails] = useState([]);\n    const [spinner, setSpinner] = useState(true);\n    const [weeks, setWeeks] = useState();\n    const [lastDoc, setLastDoc] = useState([])\n    const [target, setTarget] = useState();\n    const [showDelete, setShowDelete] = useState(false)\n\n\n    const [ratecompany, setRateCompany] = useState(false);\n\n    useEffect(() => {\n        const user = JSON.parse(sessionStorage.getItem('key'));\n        setUser(user);\n\n        axios.get(`http://localhost:5000/individuals/staff/${user.id}`)\n            .then(res => {\n                if (res.data.length > 0) {\n                    setStaff(res.data);\n                }\n            })\n            .catch(err => console.log(err));\n\n        //check if this is the beginning of the term and get the total weeks for the term\n\n        axios.get(`http://localhost:5000/rate/teacher/check/${user.org_name}`)\n            .then(res => {\n\n                setLastDoc(res.data.reverse()[0])\n            })\n            .catch(err => console.log(err));\n\n    }, [])\n\n    //get the new school week and show rating modal\n    const getSchoolWeeks = (w) => {\n        setWeeks(w);\n        setSchoolWeeksModal(false);\n        displayDetails(target)\n\n    }\n\n\n    //close add modal and reload staff\n    const closeModal = () => {\n        setShow(false);\n        setShowEdit(false)\n\n        axios.get(`http://localhost:5000/individuals/staff/${user.id}`)\n            .then(res => {\n                if (res.data.length > 0) {\n                    setStaff(res.data);\n                }\n            })\n            .catch(err => console.log(err));\n    };\n\n\n    //get currently clicked staff\n    const getDetails = (e) => {\n        setTarget(e.currentTarget)\n        const current = e.target.getAttribute('data-current');\n\n\n        //show company rating modal\n        if (current === 'rate' && user.org_type === 'company') {\n\n            const id = e.target.getAttribute('data-id');\n\n            const staffDetails = staff.filter(st => {\n                return st._id === id\n            })\n\n            setDetails(staffDetails[0]);\n            setRateCompany(true)\n\n\n        } else {\n\n            if (current === 'rate') {\n                if (lastDoc === undefined) {\n                    setTarget(e.currentTarget)\n                    setSchoolWeeksModal(true)\n                    toast(\"Please tell us how many weeks are in your calendar this term\", \"info\");\n                    return;\n\n                } else if (lastDoc.total_weeks === lastDoc.current_week) {\n                    setTarget(e.currentTarget)\n                    setSchoolWeeksModal(true);\n                    toast(\"your Current Term has ended. Please start a new term\", \"info\");\n                    return;\n                }\n            }\n\n\n            displayDetails(target, e)\n        }\n    }\n\n    //display modal based on selected action\n    const displayDetails = (target, e) => {\n\n        const id = e ? e.target.getAttribute('data-id') : target.getAttribute('data-id');\n        const current = e ? e.target.getAttribute('data-current') : target.getAttribute('data-current');\n\n        const loadModal = () => current === \"view\" ? setShowDetails(true) : current === \"rate\" ? setShowRating(true) : current === \"edit\" ? setShowEdit(true) : current === \"delete\" ? setShowDelete(true) : \"\"\n\n        const staffDetails = staff.filter(st => {\n            return st._id === id\n        })\n        setDetails(staffDetails[0]);\n        loadModal();\n    }\n\n    const closeRating = () => {\n        setShowRating(false)\n        setRateCompany(false)\n    }\n    console.log(staff)\n\n    // const status_color = \n\n    return (\n        <>\n            <div className=\"container\" style={{marginTop:\"70px\"}}>\n\n                <div className=\"container\">\n                    <div className=\"row d-flex align-items-center justify-content-center\" style={{ background: '#C4C4C4', padding:'10px'}}>\n\n                        <div className=\"col-lg-8\" ><SearchBar /></div>\n\n                        <div className=\"col-lg-4\" style={{ cursor: 'pointer' }} >\n                            {/* <span style={{ float: 'right', lineHeight: '50px', marginLeft: '10px', color: '#3F51B5', fontSize: '16px', fontWeight: 'bolder' }}> */}\n                                <div className=\"d-flex justify-content-between\">\n                                <div className=\"btn\" style={{ background: 'lightgrey' }} onClick={ex_rankingpage}>Excercise Ranking</div>\n                                <div className=\"btn\" style={{ background: 'lightgrey' }} onClick={() => setShow(!show)}>Add {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</div>\n                                {/* <div onClick={() => setShow(!show)}><AddCircleIcon fontSize=\"large\" /> Add {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</div> */}\n                                </div>\n                            {/* </span> */}\n                        </div>\n                    </div>\n                </div><br /><br />\n\n                {/* header for the rows    */}\n                {/* <div className=\"container\"> */}\n                <div className=\"row\">\n                    <div className=\"col d-flex d-inline-flex\">\n\n                        <div className=\" pl-3 d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0 text-color-2\">Name</p>\n                        </div>\n\n\n                        <div className=\"d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0\">Email</p>\n                        </div>\n\n\n                        <div className=\" d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0\">Phone</p>\n                        </div>\n                        <div className=\" d-flex flex-fill align-items-center\">\n                            <p className=\"mb-0\">Status</p>\n                        </div>\n\n                    </div>\n                </div>\n                {/* </div> */}\n\n                {\n                    staff.map(st => {\n                        return (\n                            <>\n                                <div className=\"wrapper-list py-2 mt-2\" style={{ backgroundColor: '#f5f5f5' }}>\n                                    <div className=\"container-fluid\">\n                                        <div className=\"row\">\n                                            <div className=\"col d-flex justify-content-between\">\n\n                                                <div className=\"d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-2 mb-0 text-color-2\">{st.fullname}</p>\n                                                </div>\n\n                                                <div className=\"d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-3 mb-0 \">{st.email}</p>\n                                                </div>\n\n                                                <div className=\"pr-2 d-flex flex-fill align-items-center\">\n                                                    <p className=\"ml-3 mb-0 text-color-2\">{st.phone}</p>\n                                                </div>\n                                                \n                                                <div className=\"pr-2 d-flex flex-fill align-items-center\">\n                                                    {st.sub_status_compt_mgt == 'active' ? <p className=\"ml-3 mb-0 text-color-2 badge badge-success\">{st.sub_status_compt_mgt}</p> : st.sub_status_compt_mgt == 'inactive' ? <p className=\"ml-3 mb-0 text-color-2 badge badge-danger\">{st.sub_status_compt_mgt}</p> :<p className=\"ml-3 mb-0 text-color-2 badge badge-info\">{st.sub_status_compt_mgt}</p>}\n                                                    \n                                                </div>\n\n                                                <div className=\"d-flex align-items-center ml-auto\">\n                                                    <Dropdown alignRight color={'red'} style={{ backgroundColor: '#f5f5f5' }}>\n                                                        <Dropdown.Toggle id=\"dropdown-basic\" style={{ color: 'black', fontWeight: 'bolder' }}>\n                                                            ....\n                                                        </Dropdown.Toggle>\n                                                        <Dropdown.Menu>\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"view\">View Details</Dropdown.Item>\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"edit\">Edit {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>\n                                                            {st.sub_status_compt_mgt =='active' ? <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"rate\">Rate {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item> : <Dropdown.Item disabled>Rate {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>}\n                                                            <Dropdown.Item onClick={getDetails} data-id={st._id} data-current=\"delete\">Delete {user && user.org_type === \"school\" ? \"teacher\" : \"staff\"}</Dropdown.Item>\n                                                        </Dropdown.Menu>\n                                                    </Dropdown>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </>\n                        );\n                    })\n                }\n\n\n            </div>\n            <AddStaff show={show} onHide={() => setShow(!show)} closeModal={closeModal} />\n            <StaffDetails\n                show={showDetails}\n                onHide={() => setShowDetails(!showDetails)}\n                details={details}\n                spinner={spinner}\n            />\n            <Rating\n                show={showrating}\n                onHide={() => setShowRating(!showrating)}\n                details={details}\n                spinner={spinner}\n                closeModal={closeRating}\n                weeks={weeks}\n                lastDoc={lastDoc}\n            />\n            <Edit\n                show={showEdit}\n                onHide={() => setShowEdit(!showEdit)}\n                id={details._id}\n                spinner={spinner}\n                user={user}\n                closeModal={closeModal}\n            />\n            <SchoolWeeks\n                show={schoolWeeksmodal}\n                onHide={() => setSchoolWeeksModal(!schoolWeeksmodal)}\n                getSchoolWeeks={getSchoolWeeks}\n            />\n            <CompanyStaffRating\n                show={ratecompany}\n                onHide={() => setRateCompany(!ratecompany)}\n                details={details}\n                closeModal={closeRating}\n            />\n            <DeleteStaff\n                show={showDelete}\n                onHide={() => setShowDelete(!showDelete)}\n                details={details}\n                user={user}\n            />\n            \n        </>\n    );\n}\nexport default Staff;\n\n"]},"metadata":{},"sourceType":"module"}