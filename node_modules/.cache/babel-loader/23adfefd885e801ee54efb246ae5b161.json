{"ast":null,"code":"import _defineProperty from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/mac/Desktop/esgrown/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import axios from'axios';import md5 from'md5';import{Spinner,Modal}from'react-bootstrap';import DatePicker from\"react-datepicker\";import{Card,CardContent}from'@material-ui/core';import toast from'../../../../util/toast';var AddStaff=function AddStaff(_ref){var show=_ref.show,onHide=_ref.onHide,_ref$closeModal=_ref.closeModal,closeModal=_ref$closeModal===void 0?function(){}:_ref$closeModal,_ref$refreshStaff=_ref.refreshStaff,refreshStaff=_ref$refreshStaff===void 0?function(){}:_ref$refreshStaff;var _useState=useState({name:'',email:'',gender:'',password:''}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),spinner=_useState4[0],setSpinner=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),user=_useState6[0],setUser=_useState6[1];useEffect(function(){var user=JSON.parse(sessionStorage.getItem('key'));setUser(user);},[]);var handleChange=function handleChange(e){var value=e.target.value;var name=e.target.name;setData(_objectSpread({},data,_defineProperty({},name,value)));};var notify=function notify(message,type){return toast(message,type);};//send data to server\nvar createUser=function createUser(){setSpinner(true);var tic=user.org_type==='school'?md5(data.email).substring(0,8).toUpperCase():null;var submitData={fullname:data.name,email:data.email,password:data.password,gender:data.gender,status:'individual',phone:null,dob:new Date(),country:null,state:null,org_type:user.org_type,org_name:user.org_name,org_id:user.id,sub_status:'inactive',tic:tic};axios.post('http://localhost:5000/individuals/check_email',submitData).then(function(res){if(res.data.length>0){if(res.data.org_name!=null){var addExistinUser=window.confirm(\"A user with this email already exist. Would you like to add this user as your staff\");if(addExistinUser){//get the details of the user with this email and populate the form field\naxios.post('http://localhost:5000/individuals/add',submitData).then(function(res){if(res.data){notify(\"Great! \".concat(user&&user.org_type===\"school\"?\"Teacher\":\"Staff\",\" added successful\"),'success');setSpinner(false);closeModal();refreshStaff();}}).catch(function(err){return notify(err.message,'error');});}}notify(\"User with this email already exists\",\"warn\");setData({name:'',email:'',password:'',gender:''});setSpinner(false);};if(res.data.length==0){axios.post('http://localhost:5000/individuals/add',submitData).then(function(res){if(res.data){notify(\"Great! \".concat(user&&user.org_type===\"school\"?\"Teacher\":\"Staff\",\" added successful\"),'success');setSpinner(false);closeModal();refreshStaff();}}).catch(function(err){return notify(err.message,'error');});};}).catch(function(err){return notify(err,'error');});};return React.createElement(React.Fragment,null,React.createElement(Modal,{show:show,onHide:onHide,centered:true,style:{marginTop:'50px'}},React.createElement(\"div\",{className:\"container\",style:{background:'#e9ecef'}},React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"label\",{style:{fontWeight:'bold'}},user&&user.org_type===\"school\"?\"Teacher\":\"Staff\",\" Full Name\"),React.createElement(\"input\",{type:\"text\",name:\"name\",value:data.name,onChange:handleChange,placeholder:\"Name\",className:\"form-control\",required:true}))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"label\",{style:{fontWeight:'bold'}},\"Email\"),React.createElement(\"input\",{type:\"email\",name:\"email\",value:data.email,onChange:handleChange,placeholder:\"Email\",className:\"form-control\",required:true}))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"label\",{style:{fontWeight:'bold'}},\"Gender\"),React.createElement(\"select\",{name:\"gender\",onChange:handleChange,className:\"form-control\"},React.createElement(\"option\",null,\"Gender...\"),React.createElement(\"option\",{value:\"male\"},\"Male\"),React.createElement(\"option\",{value:\"female\"},\"Female\")))),React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"label\",{style:{fontWeight:'bold'}},\"Password\"),React.createElement(\"input\",{type:\"password\",name:\"password\",value:data.password,onChange:handleChange,placeholder:\"Password...\",className:\"form-control\",required:true}))),React.createElement(Modal.Footer,null,React.createElement(\"div\",{className:\"row mt-3\"},React.createElement(\"div\",{className:\"col\"},React.createElement(\"button\",{className:\"btn mt-3 w-100 border-0\",style:{background:'#21A5E7',color:'white'},onClick:createUser},spinner?React.createElement(Spinner,{as:\"span\",animation:\"grow\",size:\"sm\",role:\"status\",\"aria-hidden\":\"true\"}):\"Add \".concat(user&&user.org_type===\"school\"?\"Teacher\":\"Staff\"))))))));};export default AddStaff;","map":{"version":3,"sources":["/Users/mac/Desktop/esgrown/src/components/corp_dashboard_components/staff/components/add-staff.js"],"names":["React","useState","useEffect","axios","md5","Spinner","Modal","DatePicker","Card","CardContent","toast","AddStaff","show","onHide","closeModal","refreshStaff","name","email","gender","password","data","setData","spinner","setSpinner","user","setUser","JSON","parse","sessionStorage","getItem","handleChange","e","value","target","notify","message","type","createUser","tic","org_type","substring","toUpperCase","submitData","fullname","status","phone","dob","Date","country","state","org_name","org_id","id","sub_status","post","then","res","length","addExistinUser","window","confirm","catch","err","marginTop","background","fontWeight","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport md5 from 'md5';\nimport { Spinner, Modal } from 'react-bootstrap';\nimport DatePicker from \"react-datepicker\";\nimport { Card, CardContent } from '@material-ui/core';\nimport toast from '../../../../util/toast';\n\n\n\n\n\nconst AddStaff = ({ show, onHide, closeModal = () => { }, refreshStaff = () => { } }) => {\n\n\n\n    const [data, setData] = useState({\n        name: '',\n        email: '',\n        gender: '',\n        password: '',\n    });\n\n    const [spinner, setSpinner] = useState(false);\n\n    const [user, setUser] = useState();\n\n    useEffect(() => {\n        const user = JSON.parse(sessionStorage.getItem('key'));\n        setUser(user)\n    }, [])\n\n\n    const handleChange = (e) => {\n        const value = e.target.value;\n        const name = e.target.name;\n\n        setData({ ...data, [name]: value })\n    };\n\n    const notify = (message, type) => toast(message, type);\n\n\n    //send data to server\n    const createUser = () => {\n\n        setSpinner(true)\n\n        const tic = user.org_type === 'school' ? md5(data.email).substring(0, 8).toUpperCase() : null;\n\n\n        const submitData = {\n\n            fullname: data.name,\n            email: data.email,\n            password: data.password,\n            gender: data.gender,\n            status: 'individual',\n            phone: null,\n            dob: new Date(),\n            country: null,\n            state: null,\n            org_type: user.org_type,\n            org_name: user.org_name,\n            org_id: user.id,\n            sub_status: 'inactive',\n            tic: tic\n\n        }\n\n\n        axios.post('http://localhost:5000/individuals/check_email', submitData)\n            .then(res => {\n\n                if (res.data.length > 0) {\n\n                    if (res.data.org_name != null) {\n                        const addExistinUser = window.confirm(\"A user with this email already exist. Would you like to add this user as your staff\");\n\n                        if (addExistinUser) {\n                            //get the details of the user with this email and populate the form field\n                            axios.post('http://localhost:5000/individuals/add', submitData)\n                                .then(res => {\n                                    if (res.data) {\n                                        notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success')\n                                        setSpinner(false);\n                                        closeModal();\n                                        refreshStaff();\n                                    }\n                                })\n                                .catch(err => notify(err.message, 'error'));\n                        } \n                    }\n                    \n                        notify(\"User with this email already exists\", \"warn\");\n\n                    setData({\n                        name: '',\n                        email: '',\n                        password: '',\n                        gender: ''\n                    });\n                    setSpinner(false);\n                };\n                if (res.data.length == 0) {\n                    axios.post('http://localhost:5000/individuals/add', submitData)\n                        .then(res => {\n                            if (res.data) {\n                                notify(`Great! ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} added successful`, 'success')\n                                setSpinner(false);\n                                closeModal();\n                                refreshStaff();\n                            }\n                        })\n                        .catch(err => notify(err.message, 'error'));\n\n                };\n            })\n            .catch(err => notify(err, 'error'));\n\n    }\n\n\n    return (\n        <>\n\n            <Modal show={show} onHide={onHide} centered style={{ marginTop: '50px', }}>\n\n                <div className=\"container\" style={{ background: '#e9ecef' }} >\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>{user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"} Full Name</label>\n                            <input type=\"text\" name=\"name\" value={data.name} onChange={handleChange} placeholder=\"Name\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Email</label>\n                            <input type=\"email\" name=\"email\" value={data.email} onChange={handleChange} placeholder=\"Email\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Gender</label>\n                            <select name=\"gender\" onChange={handleChange} className=\"form-control\">\n                                <option>Gender...</option>\n                                <option value=\"male\">Male</option>\n                                <option value=\"female\">Female</option>\n                            </select>\n                        </div>\n                    </div>\n\n                    <div className=\"row mt-3\">\n                        <div className=\"col\">\n                            <label style={{ fontWeight: 'bold' }}>Password</label>\n                            <input type=\"password\" name=\"password\" value={data.password} onChange={handleChange} placeholder=\"Password...\" className=\"form-control\" required />\n                        </div>\n                    </div>\n\n\n                    <Modal.Footer>\n                        <div className=\"row mt-3\">\n                            <div className=\"col\">\n                                <button\n                                    className=\"btn mt-3 w-100 border-0\"\n                                    style={{ background: '#21A5E7', color: 'white' }}\n                                    onClick={createUser}\n                                >\n                                    {spinner ? <Spinner as=\"span\" animation=\"grow\" size=\"sm\" role=\"status\" aria-hidden=\"true\" /> : `Add ${user && user.org_type === \"school\" ? \"Teacher\" : \"Staff\"}`}\n                                </button>\n                            </div>\n                        </div>\n                    </Modal.Footer>\n                </div>\n\n            </Modal>\n        </>\n    );\n}\nexport default AddStaff;"]},"metadata":{},"sourceType":"module"}