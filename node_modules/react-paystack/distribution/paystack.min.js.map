{"version":3,"sources":["../src/PayStack.js"],"names":[],"mappings":"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","file":"paystack.min.js","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport PropTypes from \"prop-types\";\n\nclass PayStack extends Component {\n  constructor(props) {\n    super(props);\n    this.payWithPaystack = this.payWithPaystack.bind(this);\n    this.loadScript = this.loadScript.bind(this);\n    this.loadscriptAndUpdateState = this.loadscriptAndUpdateState.bind(this);\n    this.state = {\n      ...this.props,\n      scriptLoaded: null,\n      class: this.props.class || this.props.className || \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.loadscriptAndUpdateState()\n  }\n\n  loadscriptAndUpdateState() {\n    this.setState(\n      {\n        scriptLoaded: new Promise(resolve => {\n          this.loadScript(() => {\n            resolve();\n          });\n        })\n      },\n      () => {\n        if (this.props.embed) {\n          this.payWithPaystack();\n        }\n      }\n    );\n  }\n\n  loadScript(callback) {\n    const script = document.createElement(\"script\");\n    script.src = \"https://js.paystack.co/v1/inline.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(script);\n    if (script.readyState) {\n      // IE\n      script.onreadystatechange = () => {\n        if (\n          script.readyState === \"loaded\" ||\n          script.readyState === \"complete\"\n        ) {\n          script.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      // Others\n      script.onload = () => {\n        callback();\n      };\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    for (const index in prevProps) {\n      if (prevState[index] !== this.state[index]) {\n        this.loadscriptAndUpdateState()\n      }\n    }\n  }\n\n  static getDerivedStateFromProps(nextProps, prevState) {\n    for (const index in nextProps) {\n      if (nextProps[index] !== prevState[index]) {\n        return {\n          scriptLoaded: null,\n          [index]: nextProps[index]\n        }\n      }\n    }\n\n    return null;\n  }\n\n  payWithPaystack() {\n    this.state.scriptLoaded &&\n      this.state.scriptLoaded.then(() => {\n        console.log('ref:', this.state.reference)\n        let paystackOptions = {\n          key: this.state.paystackkey,\n          email: this.state.email,\n          amount: this.state.amount,\n          ref: this.state.reference,\n          metadata: this.state.metadata || {},\n          callback: response => {\n            this.state.callback(response);\n          },\n          onClose: () => {\n            this.state.close();\n          },\n          currency: this.state.currency,\n          plan: this.state.plan || \"\",\n          quantity: this.state.quantity || \"\",\n          subaccount: this.state.subaccount || \"\",\n          transaction_charge: this.state.transaction_charge || 0,\n          bearer: this.state.bearer || \"\",\n        };\n        if (this.state.embed) {\n          paystackOptions.container = \"paystackEmbedContainer\";\n        }\n        const handler = window.PaystackPop.setup(paystackOptions);\n        if (!this.state.embed) {\n          handler.openIframe();\n        }\n      });\n  }\n\n  render() {\n    const CustomTag = `${this.props.tag}`;\n    return this.props.embed ? (\n      <div id=\"paystackEmbedContainer\" />\n    ) : (\n      <Fragment>\n        <CustomTag\n          className={this.state.class}\n          onClick={this.payWithPaystack}\n          disabled={this.state.disabled}\n        >\n          {this.state.text}\n        </CustomTag>\n      </Fragment>\n    );\n  }\n}\n\nPayStack.propTypes = {\n  embed: PropTypes.bool,\n  text: PropTypes.string,\n  class: PropTypes.string,\n  metadata: PropTypes.object,\n  currency: PropTypes.string,\n  plan: PropTypes.string,\n  quantity: PropTypes.string,\n  subaccount: PropTypes.string,\n  transaction_charge: PropTypes.number,\n  bearer: PropTypes.string,\n  reference: PropTypes.string.isRequired,\n  email: PropTypes.string.isRequired,\n  amount: PropTypes.number.isRequired, //in kobo\n  paystackkey: PropTypes.string.isRequired,\n  callback: PropTypes.func.isRequired,\n  close: PropTypes.func.isRequired,\n  disabled: PropTypes.bool,\n  tag: PropTypes.oneOf(['button', 'a', 'input']),\n};\n\nPayStack.defaultProps = {\n  tag: 'button',\n  text: \"Make Payment\",\n  currency: \"NGN\",\n  disabled: false\n};\n\nexport default PayStack;\n"]}